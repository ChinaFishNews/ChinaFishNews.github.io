<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <title>含笑饮砒霜的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="含笑饮砒霜的博客">
<meta property="og:url" content="http://chinafish.news/page/2/index.html">
<meta property="og:site_name" content="含笑饮砒霜的博客">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="含笑饮砒霜的博客">
<meta name="twitter:description">
  
    <link rel="alternative" href="/atom.xml" title="含笑饮砒霜的博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">

</head>

<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="http://tp1.sinaimg.cn/2185265952/180/5686790740/1" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">含笑饮砒霜</a></h1>
		</hgroup>

		
		<p class="header-subtitle">如果可以打造非凡应用 为什么要止步于过得去</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
						<li>关于我</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">概览</a></li>
				        
							<li><a href="/categories/进阶">进阶</a></li>
				        
							<li><a href="/categories/OC">OC</a></li>
				        
							<li><a href="/categories/Swift">Swift</a></li>
				        
							<li><a href="/categories/随笔">随笔</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/ChinaFishNews" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="http://weibo.com/2185265952/profile?topnav=1&wvr=6&is_all=1" title="weibo">weibo</a>
					        
								<a class="twitter" target="_blank" href="https://twitter.com/fishnewsdream" title="twitter">twitter</a>
					        
								<a class="linkedin" target="_blank" href="http://www.linkedin.com/in/新闻-余-ab2b19101?trk=nav_responsive_tab_profile_pic" title="linkedin">linkedin</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/AVPlayer、MoviePlayer/" style="font-size: 10px;">AVPlayer、MoviePlayer</a> <a href="/tags/Aspects-转载/" style="font-size: 10px;">Aspects,转载</a> <a href="/tags/Asstrill-Shadowsocks-云梯，壁虎漫步/" style="font-size: 10px;">Asstrill,Shadowsocks,云梯，壁虎漫步</a> <a href="/tags/Autolayout/" style="font-size: 10px;">Autolayout</a> <a href="/tags/BugHD/" style="font-size: 10px;">BugHD</a> <a href="/tags/Cocoapods/" style="font-size: 10px;">Cocoapods</a> <a href="/tags/Coding-net/" style="font-size: 10px;">Coding.net</a> <a href="/tags/Core-Graphics/" style="font-size: 10px;">Core Graphics</a> <a href="/tags/Fabric/" style="font-size: 15px;">Fabric</a> <a href="/tags/Git，GitHub-回滚，仓库/" style="font-size: 10px;">Git，GitHub,回滚，仓库</a> <a href="/tags/Leaks，Allocations-Time-Profiler/" style="font-size: 10px;">Leaks，Allocations,Time Profiler</a> <a href="/tags/MMPDeepSleepPreventer-后台无限运行/" style="font-size: 10px;">MMPDeepSleepPreventer,后台无限运行</a> <a href="/tags/MarkDown、Mou、Macdown/" style="font-size: 10px;">MarkDown、Mou、Macdown</a> <a href="/tags/Openfire-Spark/" style="font-size: 10px;">Openfire,Spark</a> <a href="/tags/Reveal/" style="font-size: 10px;">Reveal</a> <a href="/tags/RunTime-转载/" style="font-size: 10px;">RunTime,转载</a> <a href="/tags/UIBezierPath-CAShapeLayer/" style="font-size: 10px;">UIBezierPath,CAShapeLayer</a> <a href="/tags/YYKit/" style="font-size: 10px;">YYKit</a> <a href="/tags/奇巧淫技/" style="font-size: 10px;">奇巧淫技</a> <a href="/tags/奇技淫巧/" style="font-size: 10px;">奇技淫巧</a> <a href="/tags/支付宝SDK/" style="font-size: 10px;">支付宝SDK</a> <a href="/tags/环信SDK/" style="font-size: 10px;">环信SDK</a> <a href="/tags/装逼，特技/" style="font-size: 10px;">装逼，特技</a> <a href="/tags/证书，Application-Loader/" style="font-size: 10px;">证书，Application Loader</a> <a href="/tags/转载/" style="font-size: 20px;">转载</a> <a href="/tags/逆向工程/" style="font-size: 10px;">逆向工程</a> <a href="/tags/随笔/" style="font-size: 10px;">随笔</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://blog.devtang.com">唐巧的博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.superqq.com">刚刚在线</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://jj59.com">九九文章网</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.cocoachina.com">CocoaChina</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.henishuo.com">标哥的技术博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://blog.csdn.net/yiyaaixuexi/">念茜的博客</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">14级毕业生,专注于iOS开发。创建Objective-C、Swift技术开发交流群201556264,欢迎加入，共同提高!</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">含笑饮砒霜</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
			
				<img lazy-src="http://tp1.sinaimg.cn/2185265952/180/5686790740/1" class="js-avatar">
			
			</div>
			<hgroup>
			  <h1 class="header-author">含笑饮砒霜</h1>
			</hgroup>
			
			<p class="header-subtitle">如果可以打造非凡应用 为什么要止步于过得去</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">概览</a></li>
		        
					<li><a href="/categories/进阶">进阶</a></li>
		        
					<li><a href="/categories/OC">OC</a></li>
		        
					<li><a href="/categories/Swift">Swift</a></li>
		        
					<li><a href="/categories/随笔">随笔</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/ChinaFishNews" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/2185265952/profile?topnav=1&wvr=6&is_all=1" title="weibo">weibo</a>
			        
						<a class="twitter" target="_blank" href="https://twitter.com/fishnewsdream" title="twitter">twitter</a>
			        
						<a class="linkedin" target="_blank" href="http://www.linkedin.com/in/新闻-余-ab2b19101?trk=nav_responsive_tab_profile_pic" title="linkedin">linkedin</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap">
  
    <article id="post-iOS开发Autolayout进阶" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/08/iOS开发Autolayout进阶/" class="article-date">
  	<time datetime="2016-03-07T16:00:00.000Z" itemprop="datePublished">2016-03-08</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/08/iOS开发Autolayout进阶/">iOS开发Autolayout进阶</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="http://music.163.com/outchain/player?type=2&id=5023390&auto=0&height=66"></iframe><br>一直想写又不想写。因为近来网上关于Autolayout的文章不在少数，重复相同的内容没什么意思。但是只写不同的地方感觉我也写不出多少，比较心塞。既然坑都占了，那就先意思一下，接下来发现Autolayout其他特性或比较高深的用法会再继续补充。</p>
<p>自iOS6苹果就推出了Autolayout,但那时候很多人都在用AutoresizingMasks,国内对新鲜出土的技术并没有那么热衷，最主要的是改变终归是痛苦的，所以鲜有应用。iOS8之后新推出了iPhone6、iPhone6+及Sizeclass,这时候不得不使用Autolayout了。现在觉得这其实也并不是必须的，代码适配也不是不可以。</p>
<p>现在代码添加约束一般有三种，常规的约束语法、可视化格式语言约束、使用第三方组件。</p>
<h4 id="u5E38_u89C4_u7EA6_u675F"><a href="#u5E38_u89C4_u7EA6_u675F" class="headerlink" title="常规约束"></a>常规约束</h4><p>代码基本长这样</p>
<p> 高度约束（添加到yellowView身上）</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">NSLayoutConstraint *heightConstraint = [NSLayoutConstraint <span class="string">constraintWithItem:</span>yellowView <span class="string">attribute:</span>NSLayoutAttributeHeight <span class="string">relatedBy:</span>NSLayoutRelationEqual <span class="string">toItem:</span>nil <span class="string">attribute:</span>NSLayoutAttributeNotAnAttribute <span class="string">multiplier:</span><span class="number">0.0</span> <span class="string">constant:</span><span class="number">50</span>];</span><br><span class="line">[yellowView <span class="string">addConstraint:</span>heightConstraint];</span><br></pre></td></tr></table></figure>
<p>间距约束（添加到self.view身上）<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">CGFloat margin = <span class="number">20</span>;</span><br><span class="line">    [self.view <span class="string">addConstraints:</span>@[</span><br><span class="line">                                [NSLayoutConstraint <span class="string">constraintWithItem:</span>yellowView <span class="string">attribute:</span>NSLayoutAttributeLeft <span class="string">relatedBy:</span>NSLayoutRelationEqual <span class="string">toItem:</span>self.view <span class="string">attribute:</span>NSLayoutAttributeLeft <span class="string">multiplier:</span><span class="number">1.0</span> <span class="string">constant:</span>margin],</span><br><span class="line"> </span><br><span class="line">                                [NSLayoutConstraint <span class="string">constraintWithItem:</span>yellowView <span class="string">attribute:</span>NSLayoutAttributeRight <span class="string">relatedBy:</span>NSLayoutRelationEqual <span class="string">toItem:</span>self.view <span class="string">attribute:</span>NSLayoutAttributeRight <span class="string">multiplier:</span><span class="number">1.0</span> <span class="string">constant:</span> - margin],</span><br><span class="line"> </span><br><span class="line">                                [NSLayoutConstraint <span class="string">constraintWithItem:</span>yellowView <span class="string">attribute:</span>NSLayoutAttributeBottom <span class="string">relatedBy:</span>NSLayoutRelationEqual <span class="string">toItem:</span>self.view <span class="string">attribute:</span>NSLayoutAttributeBottom <span class="string">multiplier:</span><span class="number">1.0</span> <span class="string">constant:</span> - margin]</span><br><span class="line">                                ]];</span><br></pre></td></tr></table></figure></p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-08-01.png?attname=" alt=""></p>
<p>用到了一个基本公式<br><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">obj1.property1 = (obj2.property2 * multiplier)+ <span class="built_in">constant</span> <span class="built_in">value</span></span><br></pre></td></tr></table></figure></p>
<p>multiplier和constant 是向量系数和偏移量,一般还要设置translateAutoresizingMaskIntoConstraints为NO,默认是YES，使得不和系统的自动伸缩约束冲突</p>
<h4 id="u53EF_u89C6_u5316_u683C_u5F0F_u8BED_u8A00_u7EA6_u675F"><a href="#u53EF_u89C6_u5316_u683C_u5F0F_u8BED_u8A00_u7EA6_u675F" class="headerlink" title="可视化格式语言约束"></a>可视化格式语言约束</h4><p>可视化格式语言，即Visual Format Language(VFL),是为了简化Autolayout而推出的抽象语言。</p>
<p>基本长这样<br><figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="label">UIButton</span> *<span class="keyword">b1 </span>= ...</span><br><span class="line"><span class="label">UIButton</span> *<span class="keyword">b2 </span>= ...</span><br><span class="line"><span class="label">UIButton</span> *<span class="keyword">b3 </span>= ...</span><br><span class="line"><span class="keyword">b1.translatesAutoresizingMaskIntoConstraints </span>= NO<span class="comment">;</span></span><br><span class="line"><span class="keyword">b2.translatesAutoresizingMaskIntoConstraints </span>= NO<span class="comment">;</span></span><br><span class="line"><span class="keyword">b3.translatesAutoresizingMaskIntoConstraints </span>= NO<span class="comment">;</span></span><br></pre></td></tr></table></figure></p>
<p>将传入的对象引用作为value,将引用名变成字符串作为key,生成的字典如: {@”b1”:b1,@”b2”:b2,@”b3”:b3}<br><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSDictionary *diction1 = NSDictionaryOfVariableBindings<span class="list">(<span class="keyword">b1</span>,b2,b3)</span><span class="comment">;</span></span><br></pre></td></tr></table></figure></p>
<p>为vfl式子中的一些特殊含义的数字做一个名称对照表<br><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NSDictionary *diction2 = @&#123;@<span class="string">"top"</span>:<span class="constant">@20</span>,@<span class="string">"left"</span>:<span class="constant">@20</span>,@<span class="string">"right"</span>:<span class="constant">@20</span>,@<span class="string">"spacing"</span>:<span class="constant">@10</span>&#125;<span class="comment">;</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">NSString *hVFL = @<span class="string">"|-left-[b1]-spacing-[b2(b1)]-spacing-[b3(b1)]-right-|"</span>;</span><br><span class="line">NSArray *cs1 = [NSLayoutConstraint constraintsWithVisualForma<span class="variable">t:hVFL</span> option<span class="variable">s:NSLayoutFormatAlignAllCenterY</span> metric<span class="variable">s:diction2</span> <span class="keyword">view</span><span class="variable">s:diction1</span>];</span><br><span class="line">NSString *vVFL = @<span class="string">"V:|-top-[b1]"</span>;</span><br><span class="line">NSArray *cs2 = [NSLayoutConstraint constraintsWithVisualForma<span class="variable">t:vVFL</span> option<span class="variable">s:0</span> metric<span class="variable">s:diction2</span> <span class="keyword">view</span><span class="variable">s:diction1</span>];</span><br><span class="line">[self.<span class="keyword">view</span> addConstraint<span class="variable">s:cs1</span>];</span><br><span class="line">[self.<span class="keyword">view</span> addConstraint<span class="variable">s:cs2</span>];</span><br></pre></td></tr></table></figure>
<p>部分使用规则如下:</p>
<blockquote>
<p> |: 表示父视图</p>
<p> -:表示距离</p>
<p> V:  :表示垂直</p>
<p>  H:  :表示水平</p>
<p> >= :表示视图间距、宽度和高度必须大于或等于某个值</p>
<p>  \&lt;= :表示视图间距、宽度和高度必须小宇或等于某个值</p>
<p>  == :表示视图间距、宽度或者高度必须等于某个值</p>
<p>|-30.0-[view]-30.0-|:  表示离父视图 左右间距 30</p>
<p>[view(200.0)] : 表示视图宽度为 200.0</p>
<p>|-[view(view1)]-[view1]-| :表示视图宽度一样，并且在父视图左右边缘内</p>
<p>V:|-[view(50.0)] : 视图高度为  50</p>
<p>V:|-(==padding)-[imageView]-&gt;=0-[button]-(==padding)-| : 表示离父视图的距离<br>为Padding,这两个视图间距必须大于或等于0并且距离底部父视图为 padding。</p>
<p>[wideView(&gt;=60@700)]  :视图的宽度为至少为60 不能超过  700 </p>
</blockquote>
<p>这里只是基本的部分使用规则，要了解更多请自行查阅。</p>
<h4 id="u4F7F_u7528_u7B2C_u4E09_u65B9_u7EC4_u4EF6"><a href="#u4F7F_u7528_u7B2C_u4E09_u65B9_u7EC4_u4EF6" class="headerlink" title="使用第三方组件"></a>使用第三方组件</h4><p>UIView+Autolayout下载地址：<a href="https://github.com/ChinaFishNews/UIView-AutoLayout.git" target="_blank" rel="external">https://github.com/ChinaFishNews/UIView-AutoLayout.git</a></p>
<p>Masonry下载地址 : <a href="https://github.com/ChinaFishNews/Masonry.git" target="_blank" rel="external">https://github.com/ChinaFishNews/Masonry.git</a></p>
<p>在最初的时候使用的是UIView+Autolayout，后来发现Masonry就基本使用Masonry了，这两个用起来都很好上手。</p>
<h6 id="UIView+Autolayout_u4E00_u822C_u7528_u6CD5"><a href="#UIView+Autolayout_u4E00_u822C_u7528_u6CD5" class="headerlink" title="UIView+Autolayout一般用法"></a>UIView+Autolayout一般用法</h6><p>直接设置大小<br><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="list">[<span class="keyword">_redView</span> autoSetDimensionsToSize:CGSizeMake<span class="list">(<span class="keyword">200</span>, <span class="number">200</span>)</span>]<span class="comment">;</span></span></span><br></pre></td></tr></table></figure></p>
<p>设置除顶部距四周的间隔，然后设置高度<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[_redVeiw autoPinEdgesToSuperviewEdgesWithInsets:UIEdgeInsetsMake(<span class="number">20</span>, <span class="number">20</span>, <span class="number">20</span>, <span class="number">20</span>)excludingEdge:ALEdgeTop]; </span><br><span class="line"></span><br><span class="line">[_redView autoSetDimension:ALDimensionHeight toSize:<span class="number">100</span>];</span><br></pre></td></tr></table></figure></p>
<p>直接设置四周间隔<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[_redView autoPinEdgesToSuperviewEdgesWithInsets:UIEdgeInsetsMake(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)];</span><br></pre></td></tr></table></figure></p>
<h6 id="Masonary_u4E00_u822C_u7528_u6CD5"><a href="#Masonary_u4E00_u822C_u7528_u6CD5" class="headerlink" title="Masonary一般用法"></a>Masonary一般用法</h6><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">UIEdgeInsets padding = UIEdgeInsetsMake(<span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>, <span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">[view1 mas_makeConstraints:^(MASConstraintMaker *make) &#123;</span><br><span class="line"></span><br><span class="line">    make.top.equalTo(superview.mas_top).<span class="keyword">with</span>.<span class="command">offset</span>(padding.top);           	make.left.equalTo(superview.mas_left).<span class="keyword">with</span>.<span class="command">offset</span>(padding.left);</span><br><span class="line">    make.bottom.equalTo(superview.mas_bottom).<span class="keyword">with</span>.<span class="command">offset</span>(-padding.bottom);</span><br><span class="line">    make.right.equalTo(superview.mas_right).<span class="keyword">with</span>.<span class="command">offset</span>(-padding.right);</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
<p>或者直接这样<br><figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="collection">[view1 mas_makeConstraints:^<span class="list">(<span class="keyword">MASConstraintMaker</span> *make)</span> <span class="collection">&#123;</span><br><span class="line">    make.edges.equalTo<span class="list">(<span class="keyword">superview</span>)</span>.with.insets<span class="list">(<span class="keyword">padding</span>)</span><span class="comment">;</span></span><br><span class="line">&#125;</span>]</span><span class="comment">;</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">make.top.mas_equalTo(<span class="number">42</span>);</span><br><span class="line">make.height.mas_equalTo(<span class="number">20</span>);</span><br><span class="line">make.size.mas_equalTo(CGSizeMake(<span class="number">50</span>, <span class="number">100</span>));</span><br><span class="line">make.edges.mas_equalTo(UIEdgeInsetsMake(<span class="number">10</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">0</span>));</span><br><span class="line">make.left.mas_equalTo(view).mas_offset(UIEdgeInsetsMake(<span class="number">10</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">0</span>));</span><br></pre></td></tr></table></figure>
<figure class="highlight clojure"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="collection">[view1 mas_makeConstraints:^<span class="list">(<span class="keyword">MASConstraintMaker</span> *make)</span> <span class="collection">&#123;</span><br><span class="line">    self.topConstraint = make.top.equalTo<span class="list">(<span class="keyword">superview.mas_top</span>)</span>.with.offset<span class="list">(<span class="keyword">padding.top</span>)</span><span class="comment">;</span></span><br><span class="line">    make.left.equalTo<span class="list">(<span class="keyword">superview.mas_left</span>)</span>.with.offset<span class="list">(<span class="keyword">padding.left</span>)</span><span class="comment">;</span></span><br><span class="line">&#125;</span>]</span><span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p>这只是随便举例，想更详细的了解可以到Github源码处具体学习下。</p>
<p>以上，代码添加约束总体较为繁琐，然而有些时候布局比较繁杂、不方便在Storyboard添加的只能只用代码来添加约束了。现在对我而言基本是一般约束直接在Storyboard上拖拽添加，一些不太方便的需要代码添加约束的使用Masonary。</p>
<h4 id="u5728Storyboard_u4E0A_u6DFB_u52A0_u7EA6_u675F"><a href="#u5728Storyboard_u4E0A_u6DFB_u52A0_u7EA6_u675F" class="headerlink" title="在Storyboard上添加约束"></a>在Storyboard上添加约束</h4><p>iOS9之后已经可以使用引用了，把Storyboard拆分成多个。多人合作项目的时候经常会产生冲突，Storyboard的冲突改起来比较酸爽，Sotryboard其实是一个巨大的XML文件，之前每次产生冲突都需要以XML文件的形式打开Storyboard修改冲突。即便现在可以把Storyboard拆分成多个，但有时冲突依然不可避免，XML文件其实也并不可怕，毕竟多改几次就习惯了。</p>
<p>添加约束其实比较降低效率，随着布局的繁杂效率下降得更为明显，只在在硬件提升的同时一般我们体会的并不明显。iOS9之后新加了UIStackView,一个管理视图的容器，这样只需要对外面的这个容器添加约束，里面的只需要设置一些属性，虽然归根结底还是设置约束。虽然UIStackView是iOS9之后，但是网上已经有支持iOS9以下的框架，叫FDStackView，下载地址:<br><a href="https://github.com/ChinaFishNews/FDStackView.git" target="_blank" rel="external">https://github.com/ChinaFishNews/FDStackView.git</a></p>
<p>下载后导入项目即可，无需做其他配置，即可在iOS9以下使用StackView。</p>
<p>先上个图大家感受一下Autolayout</p>
<p> <img src="http://7xqjid.com1.z0.glb.clouddn.com/4.png?attname=" alt="">  </p>
<p> <img src="http://7xqjid.com1.z0.glb.clouddn.com/5.png?attname=" alt="">  </p>
<p> <img src="http://7xqjid.com1.z0.glb.clouddn.com/6.png?attname=" alt=""></p>
<p>默认大家都已经可以基本使用Autolayout.</p>
<p>一般在右下角可以方便的添加约束，也有人通过菜单栏中Editor设置，其实也可以按住control键，点击控件拖拽</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-08-03.png?attname=" alt=""></p>
<p>添加约束后有时想知道在不同设备上的布局，这时候可以选中控制器，改变Size的大小，也可以这样</p>
<p>按住option键点击Main.Storyboard</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-08-04.png?attname=" alt=""></p>
<p>然后可以添加设备</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-08-05.png?attname=" alt=""></p>
<p>还有时候想观察视图的层次机构，可以在运行时点击Debug View Hierarchy</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-08-07.png?attname=" alt=""></p>
<p>其实还可以使用工具Reveal,之前的博文中有讲到。</p>
<p>在添加约束的时候，左侧一般是这样的</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-08-08.png?attname=" alt=""></p>
<p>为什么有的约束在这个控件下，有的约束在其他控件下呢？  是因为只有设置当前控件宽高的时候约束才会出现在当前控件下，设置和其他控件相对位置、距离的时候，会找到他们最近的父控件，在他们最近的父控件下显示约束。</p>
<p>使用Autolayout的时候，有个属性IntrinsicContentSize，UILabel,UIButton,UIImageView拥有这个属性，可以自己根据内容调整大小，不用设置宽和高。文字有多长就显示多长，图片有多大，就显示多大，对于哪些View有IntrinsicContentSize，苹果给了一张表:</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-08-09.png?attname=" alt=""></p>
<p>这张表显示，UIView和NSView是没有IntrinsicContentSize的。Sliders只能定义width。Sliders的height拥有IntrinsicContentSize，Labels, buttons, switches,and text fields完全支持，Text viewsand image views，在有内容的时候支持，没有内容的时候不支持。对于没有这个属性的，我们也希望他拥有默认宽高的话该怎么办呢？我们可以重写IntrinsicContentSize方法,这样就可以拥有默认的宽高<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">- (CGSize)intrinsicContentSize</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> CGSizeMake(<span class="number">100</span>,<span class="number">100</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>对于IntrinsicContentSize，Autolayout又把他分成了2个部分：ContentHugging和CompressionResistance。我们点击控件的时候在右侧会发现</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-08-10.png?attname=" alt=""></p>
<p>ContentHugging是内容凝聚力，优先级是250，表示View的宽度和高度紧靠内容，不让其扩展的力量</p>
<p>CompressionResistance是指压缩阻力，优先级是750，表示当有力量要对其进行压缩的时候，其阻力的大小</p>
<p>对于同一个View，ContentHugging和CompressionResistance不会同时起作用</p>
<p>而我们添加约束的时候是这样的,优先级是1000</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-08-11.png?attname=" alt=""></p>
<p>当一个label有文字的时候，label会存在一个内容的Size。<br>如果有外力让其size扩张，ContentHugging会起作用，外力大于ContentHugging的力量，label的size由外力决定，反之，label的Size由内容决定。<br>如果有外力让其size压缩，CompressionResistance会起作用，外力大于CompressionResistance的力量，label的size由外力决定，反之，label的Size由内容决定。</p>
<p>也就是说如果我们给label加了一个宽度约束，line设为0，我们在给line设置内容的时候，一旦内容size大于其原有大小的时候label的高度就会增加，而当我们只给label添加一个宽度的时候，一旦我们设置的内容size大于其原有宽度的时候label的宽度就会增加。而当我们同时设置宽度和高度约束的时候，无论我们怎么设置内容，其就会被固定在我们设置的这个size里，因为添加约束的优先级默认是1000，优先级最大，默认会执行这个。</p>
<p>constraint的优先级(Priorities),优先级越高，力量越大，越被优先执行。系统的优先级由1~1000的数字表示，值越大，优先级越高。NSLayoutConstraint中一共定义了4种比较常用的优先级<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">float</span> <span class="built_in">UILayoutPriority</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="built_in">UILayoutPriority</span> <span class="built_in">UILayoutPriorityRequired</span> <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">6</span>_0) = <span class="number">1000</span>;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">static</span> <span class="keyword">const</span> <span class="built_in">UILayoutPriority</span> <span class="built_in">UILayoutPriorityDefaultHigh</span> <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">6</span>_0) = <span class="number">750</span>; </span><br><span class="line"> </span><br><span class="line"> <span class="keyword">static</span> <span class="keyword">const</span> <span class="built_in">UILayoutPriority</span> <span class="built_in">UILayoutPriorityDefaultLow</span> <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">6</span>_0) = <span class="number">250</span>; </span><br><span class="line"> </span><br><span class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="built_in">UILayoutPriority</span> <span class="built_in">UILayoutPriorityFittingSizeLevel</span> <span class="built_in">NS_AVAILABLE_IOS</span>(<span class="number">6</span>_0) = <span class="number">50</span>;</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p>UILayoutPriorityRequired: 必须级别优先级，值为最高值1000，一般平时定义约束，默认都是这个优先级。</p>
<p>UILayoutPriorityDefaultHigh: 高优先级，值为750，CompressionResistance的默认优先级是这个。</p>
<p> UILayoutPriorityDefaultLow: 低优先级，值为250，ContentHugging的默认优先级是这个</p>
<p>UILayoutPriorityFittingSizeLevel: 极低的优先级，让系统估算Size的时候使用，不适合做约束</p>
</blockquote>
<p>知道了各个属性的默认优先级之后，就可以解释为什么一般情况我们给Lable设置Size约束之后，Label由我们设置的Size决定，而不是由其内容决定。因为我们没有特意设置优先级，用的都是默认优先级。Size约束的优先级比CompressionResistance和ContentHugging的优先级高。如果我们想让Label由内容决定，我们可以不设置Size约束或者调低自己Size约束的优先级。</p>
<p>上面参考了网上的一篇文章，讲的很赞，并且给了一个案例。</p>
<p>假设有2个Label，并列放着，他们都是使用IntrinsicContentSize自动根据文字适应宽度。效果如图所示：</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-08-12.png?attname=" alt=""></p>
<p>那么我们设置一个优先级为500宽度为100的约束(100小于Label2的宽度，大于Label1的宽度)</p>
<p>结果是2个Label都变成100的宽度，还是都保持原来的宽度不变？还是一个变成100，一个保持原来的宽度？我们Run一下：</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-08-13.png?attname=" alt=""></p>
<p>Label1变成了100，Label2还是原来的宽度，为什么呢？</p>
<blockquote>
<p> Label1的IntrinsicContentSize宽度比100小，所以当添加一个宽度为100的约束时，ContentHugging在起作用。ContentHugging的优先级为250。宽度为100的约束优先级为500大于ContentHugging。所以宽度为100.</p>
<p>  <br>Label2的IntrinsicContentSize宽度比100大。所以当添加一个宽度为100的约束时，CompressionResistance在起作用，CompressionResistance的优先级为750。宽度为100的约束优先级为500小于CompressionResistance。所以宽度还是IntrinsicContentSize的宽度</p>
</blockquote>
<p>正常情况下我们在设置Label的时候，给它加个宽度约束，运行是这样的</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-08-15.png?attname=" alt=""></p>
<p>款读设置的是100，高度没有设置，内容过多的时候回自动自适应，不用使用代码计算size。但是我们设置宽度是100，但是内容太少的时候右边会有空白，这时候怎么办呢?我们可以将宽度设为less than or equal 100,这样在内容少的时候就是这样的</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-08-16.png?attname=" alt=""></p>
<p>这样就解决了内容少而右边有空白的问题。有时候可能没有内容，但是我们又希望它占位，这时候该怎么办呢？我们可以这样设置，即便在没有内容的时候依然在占位</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-08-17.png?attname=" alt=""></p>
<p>使用的过程中被还会有一些其他的问题</p>
<blockquote>
<ul>
<li><p>对于Autolayout，制作动画和以往也有些不同，使用Frame的时候，我们做动画一般都调用-animateWithDuration:animations:方法，在animations的block里面调整Frame即可，使用Autolayout之后，由于Autolayout是延迟布局的，并不是约束更新之后就立刻布局，所以大家可以发现。在-animateWithDuration:animations方法里面修改约束是不能实现动画的。而使用Autolayout该怎么做呢？  应该是在block外改变约束，在block内调用layoutIfNeeded方法。</p>
</li>
<li><p>Autolayout自动布局是在UIView的layoutSubviews中，所以TableView上的子view(如：cell，headerView，footerView)使用了Autolayout，tableView在布局的时候调用layoutSubviews，就会抛出异常。直接对TableView使用Autolayout是不会有问题的，TableView是否调用layoutSubviews在于他上面的子view是否使用Autolayout，而不是他本身。<br>正确的做法是:如果是cell，我们经常使用[cell addSubview:view]再对view做一个相对cell的约束，这时候就会出现问题。解决方案就是使用[cell.contentView addSubview:view]。我们约束是对cell的contentView添加，跟cell无关。tableView就不会调用layoutSubviews了。<br>如果是headerView或者footView。解决方案是直接使用frame，或者自己定义一个类似Cell的contentView的view，子view相对contentView布局使用Autolayout，contentView对headerView布局使用frame。</p>
</li>
<li><p>使用中还会发现一个特殊的控件，UIScrollView,因为contentSize跟着里面的子view发生变化。正确的做法是给UIScrollview添加一个ContentView,设置edge均为0，如果垂直滚动那就设置一个宽度，反之设置一个高度约束。<b></b></p>
</li>
<li><p>使用Autolayout之后，系统中多了一个更新约束的方法updateConstraints。updateConstraints方法仅用于提升性能。当你更新大量约束，发现由于约束太多，布局有点卡。这时候你可以使用updateConstraints，因为在updateConstraints中更新约束会批量操作，能获得更好的性能。</p>
</li>
</ul>
</blockquote>
<p>以上，只是Autolayout部分用法，具体的需要在项目中体验，注意点比较多。</p>
<p>就先到这里，今天妇女节，祝广大女同胞节日快乐。觉得应该放半天假，然而这么人性化得公司毕竟不多！</p>
<hr>
<p>如有任何疑问或问题请联系我:fishnewsdream@gmail.com,欢迎交流，共同提高！</p>
<p>Objective-C/Swift技术开发交流群201556264，讨论何种技术并不受限，欢迎各位大牛百家争鸣！</p>
<p><a href="http://www.ggteach.com/index.html" target="_blank" rel="external">刚刚在线工作室</a>，欢迎关注或提出建设性意见！</p>
<p><a href="http://bbs.ggteach.com" target="_blank" rel="external">刚刚在线论坛</a>, 欢迎踊跃提问或解答！</p>
<p>如有转载，请注明出处，谢谢！</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Autolayout/">Autolayout</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/进阶/">进阶</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-iOS开发证书制作及项目上传流程" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/05/iOS开发证书制作及项目上传流程/" class="article-date">
  	<time datetime="2016-03-04T16:00:00.000Z" itemprop="datePublished">2016-03-05</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/05/iOS开发证书制作及项目上传流程/">iOS开发证书制作及项目上传流程</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="http://music.163.com/outchain/player?type=2&id=5023390&auto=0&height=66"></iframe>


<p>iOS开发中证书制作和项目上传发布这一块，很多初学者都对此比价困扰，有些即便是工作有些时日的对此可能也不是很清楚，毕竟可能只是写个代码，这一块并不怎么参与。我刚工作那会开始时一直在网上看了很多文档，总是过一段时间就会忘，后来参与项目中操作几次基本就很顺手了。</p>
<p>我也见过工作几年的对此不了解的人，然而这什么都说明不了，人家工作能力依然是很强。只是术业有专攻，在很多专项上造诣很深，但是这却被很多人低估。</p>
<p>我所见过的觉得技术比较厉害的人，身上并没有什么戾气，相反会觉得自己知之甚少，毕竟接触的越多觉得不会的就更多。而表现很嚣张的人一般有两类，一是在大学时就有接触，并且小有研究，这时候正是心高气傲的年纪，经常会指点江山，越俎代庖替那些行业大佬做决断，另一种就是刚工作没多久觉得了解的差不多了的人,能力大小决定视野层次，有时候真的觉得这也许和能力没有关系，只和为人有关。犹如以前看到的一段子，一人问学计算机专业的朋友能不能帮忙盗个QQ密码，帮忙写个游戏外挂，帮忙刷个票等，得到不能的答案后心里嘀咕:”你tm不是学计算机的吗”。正因为学计算机的，所以才知道这事情的难度，然而外人可能并不知道，理所当然的觉得这并非难事，说不定还会想这点事都办不成这tm的也算是计算机高材生？工作以来偶尔在群里给一些人解决问题，慢慢的意识到一些现象，现在也就仅限于常联系的那几个人了。别人问你问题的时候，也许是听别人说了你很厉害，也可能只是单纯的看你工作几年了觉得肯定有一定能力，也许仅仅是因为看到你刚刚为其他人解决了一个问题，这时候如果你不会，那结果很自然，他们会觉得这货也并不怎么样，而如果你会但是你所讲的可能他们并不是听得很懂，他们又会觉得你是在装逼，可能是在不懂装懂，只有你很顺利的解决他们的问题并且他们很快就能理解的时候，这才是一次皆大欢喜的问答流程，然而这种可能性并不大，随着问题的难度越来越深，这种可能性越来越小。所以现在很多时候，如果我觉得并不能马上解决，或者要解决又需要科普一些其他的技术要点，或者本身就不太清楚，干脆就直接说不会或者没时间，这已经违背了我的意愿，然而我却越来越多的这么做，这不是一个好现象。</p>
<p>在生活中也时常会有这种问题，本身计算机专业，但是我大学时是个典型的渣渣，虽然现在也是，但是大学更甚。经常会有朋友的电脑出问题打电话咨询我，尽管经常我觉得回答的还可以，但问题却少有解决，所以我一次又一次的让他们失望了，虽然有时觉得这根本不是一个问题，但是结果很明显。有时是他们的执行力的问题，有时是我的问题，或描述不清楚，或力所不能及。我把这当成一个遗憾，没错，是遗憾。</p>
<p>有人会说，真正的大牛并不介意他人的观点，毕竟实力在那摆着。这话从来都是个伪命题，纯粹是在扯犊子，难道包括诋毁吗？古代中国文人无法容忍别人看低自己的风骨，现在做技术的也一样不能接受别人对自己的质疑，尤其是来自技术不堪的人的质疑。哪些人可以做到“我不在意，便伤不到我”这个境界，只有那些功成名就，已经不需要考虑外界声音的时候。我对陌生人的贬低、谩骂、不信任毫无在意，但是我的那些朋友的声音我没法不在意，因为他们是我生活的一部分，是这样。</p>
<p>以上，旨在说明，一切技术要点并不是衡量一个开发人员的能力标杆。闻道有先后没错，术业有专攻也是真的,别去妄图通过某个单一指标去判断技能水平，很多人总是惊艳与无形处！</p>
<p>这都是在扯犊子，说正经的。</p>
<hr>
<p>开发者账号分为个人、公司和企业，当然还有教育结构。公司账号相比个人账号多了些账号管理的设置，允许多个开发者协作开发，在申请时须填写公司的邓白氏编码(DUNS Number),企业账号不能发布应用到App Store,只能企业内部使用，申请时也需要邓白氏编码。而教育账号费用0美元 ，只能教育机构或学院内部使用，必须是苹果iOS开发者计划授权机构，不能对外正式发布iOS应用程序。</p>
<p>开发者账号在申请后，需要创建开发证书和发布证书。一般而言，一个账号需要一个开发证书和一个发布证书，使用过程可能还有若干个推送证书。其实可以创建不止一个开发和发布证书，但是再次创建的时候，之前的就不能使用了，所以账号申请下来以后，开发和发布证书创建好后，下载下来，导出私钥，保存好，在组内其他成员使用的时候避免再次创建开发和发布证书，只需把私钥给他即可。<br>账号申请下来后如何创建证书呢？下面演示一下流程</p>
<p><b> 首先打开钥匙串，创建一个证书签名请求文件，点击从证书颁发机构请求证书</b></p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-05-05.png?attname=" alt=""></p>
<p>电子邮件地址填写申请的开发者账号，选择存储到磁盘，找个位置存放</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-05-06.png?attname=" alt=""></p>
<p>接下来进入官网，如下图，Certificaes下面的即是该账号下的证书文件，1是推送证书(发布模式)，对应的Type是<code>Apple Push Services</code>，2是开发证书，对应的Type是<code>iOS Development</code>,3是发布证书，对应的Type是<code>iOS Distribution</code>,4是推送证书(开发模式)，对应的Type是<code>Apns Development iOS</code>,如果项目不需要推送，推送证书完全不需要创建，只需要一个开发证书一个发布证书即可。初次申请账号后这里面是空的，需要自己创建一个开发和发布证书。点击右上角的+号</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-05-08.png?attname=" alt=""></p>
<p>然后选择创建的证书类型，1是开发证书，2是推送证书(开发模式)，3是发布证书，4是推送证书(发布模式)，选择后然后下一步</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-05-09.png?attname=" alt=""></p>
<p>这一步是选择App ID,也就是项目的唯一标示，对应的是项目中的Bund ID,在制作推送证书的时候需要这一步，普通的开发证书和发布证书不会出现这一步，接下来会讲到</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-05-15.png?attname=" alt=""></p>
<p><code>Choose File</code>点击选择刚才我们生成的证书签名请求文件，再下一步即生成了相应的证书。把证书下载下来，双击安装，这时钥匙串里就会显示我们生成的证书。</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-05-16.png?attname=" alt=""></p>
<p>打开钥匙串，如下图，我这里1、2都是推送证书(开发模式),3、4都是推送证书(发布模式),5是系统证书，6、7、8是开发证书，因为我有三个开发账号，所以这里有三个开发证书，9是发布证书。这个时候官网上就会显示我们生成的证书，但是别人下载的时候安装并不能使用，因为没有证书签名请求文件，安装后会显示缺少私钥，就是8、9下面钥匙显示的地方。那别人怎么拿到这个证书呢？记住，不要重新去创建，会导致之前的不能使用，需要我们把开发和发布证书的私钥导出来，可以随便设置一下密码，发给需要用到的人，这个导出的p12文件包含证书和签名请求。以前在Xcode4.5的时候还有一种导出方法，就是通过Xcode直接导出来一个文件即可，但是Xcode4.5之后就不再支持这种方法了。</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-05-18.png?attname=" alt=""></p>
<p>另外，证书签名请求文件，即我们第一步生成的那个CSR文件，只能使用一次，如果需要再次制作证书需要重新生成证书签名请求文件。证书做好之后，如果我们想真机调试，还需要做什么呢？  我们每个程序都有一个Bund ID,用来唯一标示一个程序。这个Bund ID在推送的时候需要使用到，苹果需要根据Bund Id来找到手机上的指定应用。下图Identifiers目录下App IDS就需要填写项目签名，也就是标示。这里是使用反向域名的形式，一般是com.公司名.*。分为两种，1是Explict App ID，固定标示，这个要和项目的Bund ID严格一致，2是Wildcard App ID广域标示，*是通配符，可以匹配所有项目。如果项目需要用到推送，需要创建一个固定标示，因为推送需要根据Bund ID找到手机上的应用。如果不需要推送，两种都可以使用，为了方便，不推送的情况下建议使用通配符</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-05-11.png?attname=" alt=""></p>
<p>下图是我的一些App ID,1、2、5均使用了通配符，其中使用1的App ID可以调试所有的应用，3、4是固定标示。</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-05-10.png?attname=" alt=""></p>
<p>接下来还要添加我们的设备，告诉苹果哪些设备需要用来调试。个人和公司账号都是99台的上限，企业是299台,只在开发模式下需要。将设备的UDID添加进来</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-05-12.png?attname=" alt=""></p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-05-13.png?attname=" alt=""></p>
<p>接下来是生成描述文件</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-05-19.png?attname=" alt=""></p>
<p>描述文件分为三种，开发(iOS App Development)、发布(App Store)和测试(ADHoc),ADHoc是指打包后用来测试的，有时候需要在上传到App Store前测试一下，选择后进行下一步</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2015-03-05-20.png?attname=" alt=""></p>
<p>这个时候需要选择App ID,如果选择含有通配符的App ID,那就可以运行在所有符合这个App ID的项目中，如果选择固定标示的App ID,那生成的描述文件则只能运行在指定Bund ID的项目上。</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-05-21.png?attname=" alt=""></p>
<p>这一步需要选择证书，如果上一步选的是开发环境下的描述文件，那这一步就需要选择开发证书，一般来说这里只有一个开发证书。但是也有可能其他人也创建了证书，那这里就可能不止一个了。可以根据过期日期判断创建先后顺序，不要同时选择多个，只需要选择最新的证书，反之这里就是发布证书。</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-05-22.png?attname=" alt=""></p>
<p>这一步是选择需要调试的设备，只在开发模式下和ADHoc模式下才会有这个选项，一般都全部勾选</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-05-23.png?attname=" alt=""></p>
<p>这就生成了后缀为.mobileprovision的描述文件，可以通过这个描述文件判断类型，是开发还是发布，还可以看App ID，所选设备数、过期日期等信息。然后下载下来双击安装</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-05-24.png?attname=" alt=""></p>
<p>这样所需要的文件就全部生成了。在Xcode中需要做些配置。1处是开发证书，点击如果没有显示，可能是没有证书或者缺少私钥，说明之前的步骤有问题，需要重新检查一下，2处点击应该显示的是发布证书，3、4分别设置为开发和发布模式下的描述文件。</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-05-25.png?attname=" alt=""></p>
<p>注意，有时描述文件可能会被更新的比较频繁，因为调试设备一旦增加就需要更新描述文件，有的人会通过Xcode直接生成描述文件，这样官网上描述文件的后面一半都会标有Mangeged by Xcode,最好别这么干，一来显的不专业且比较乱，二是极端情况下可能会导致该账号下的所有证书和描述文件都不可用。在更新描述文件的时候，有时候下载下来安装好后依然不可用，这可能是因为系统还在使用之前我们本地的描述文件，这个时候可以去存放描述文件的目录下删除，如下图所示</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-05-26.png?attname=" alt=""></p>
<p>但是名字都是一串数字，怎么判断对应的是哪个描述文件呢？可以到Xcode中去查看,点击选中的描述文件，再点击other就会出现对应的一串数字。现在Xcode感觉是越来越不稳定了，很多时候都感觉反应慢半拍，所以再重新下载安装描述文件的时候最好先把之前对应的删了。</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-05-27.png?attname=" alt=""></p>
<p>这时候就可以真机调试了。如果其他组员也参与项目需要真机调试怎么办呢？之前有说到，如下图，到钥匙串中导出对应证书的私钥给到你的组员，这个私钥其实包含证书和证书签名请求，双击安装即可。至于描述文件你给到组员或者他们自己到官网去下载都可以</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2015-03-05-28.png?attname=" alt=""></p>
<hr>
<p>在项目完成后，需要打包测试或提交到App Store,在下图Provisioning Profile下Release模式下选择对应的描述文件，Coding Signing Identity下Release模式下选择相应的证书，直接选Automatic也可以，系统可以智能识别。然后菜单栏Product下选择Archive开始打包。注意，在选择设备的时候最好不要选择你的手机，而是选择Generic iOS Device，否则只会在你当前手机环境下进行编译打包</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-05-29.png?attname=" alt=""></p>
<p>这时候可以直接点击Upload to App Store,接下来还有选择开发者账号这一步，但是这种通过Xcode直接上传的方式近来很多人都说特别慢或者上传不成功，上传失败的话可以使用另外一种方式Application Loader。右下角有是否下载dSYM文件，也就是符号集，每一个.dSYM文件都有一个UUID，和.app文件中的UUID对应，代表着是一个应用。而.dSYM文件中每一条崩溃信息也有一个单独的UUID，用来和程序的UUID进行校对。使用友盟或者百度错误统计的时候，一些运行时或者内存错误并不能判断出具体位置，这个时候就需要通过.dSYM文件。每次Archive一个包之后，都会随之生成一个dSYM文件，当程序崩溃的时候，我们可以获得到崩溃的错误堆栈，但是这个错误堆栈都是0x开头的16进制地址，需要我们使用Xcode自带的symbolicatecrash工具来将.Crash和.dSYM文件进行符号化，就可以得到详细崩溃的信息。</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-05-30.png?attname=" alt=""></p>
<p>点击Export导出包，分别是App Store、测试、企业分发和开发包，选择后下一步</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-05-31.png?attname=" alt=""></p>
<p>注意，左下角的对勾默认是不勾的，如果是企业账号打包，要做企业分发，需要勾选左下角的对勾</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-05-32.png?attname=" alt=""></p>
<p>然后就需要填写ipa在服务器上的路径及应用名称，这和以前企业打包的时候流程有些偏差.Xcode 6以下ipa 和 plist 同时生成，Xcode6以上 只生成ipa,不过plist文件在包里也可以找到，然后将这两个文件交给服务器人员，然后将plist在服务器上的地址加到字符串“itms-services://?action=download-manifest&amp;url=”之后，将这个地址用浏览器打开就会提示安装应用。</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-05-33.png?attname=" alt=""></p>
<p>如果只是个普通的测试包，可以直接上传到蒲公英分发平台，通过链接下载安装即可。如果上传到App Store可以通过Aoolication Loader上传，每次上传我都会打开Vpn,5m/s的上传速度简直不能更爽，但是很多人会卡在这一步，有时候因为网络原因会上传失败。一般在早上上传成功的可能性更大一些。</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-05-34.png?attname" alt=""></p>
<p>以上，即是整个流程。包括账号申请、续费、Ituens上信息填写就不在赘述了，很多文档都比价齐全。现在整体比以前简单多了，苹果一直在优化，所以有些流程可能会有小的出入。</p>
<p>最后，扯个淡，事情没办完的感觉是痛苦的，希望早点结束，可以让我全身心的去投入战斗！</p>
<p>只是希望！</p>
<hr>
<p>如有任何疑问或问题请联系我:fishnewsdream@gmail.com,欢迎交流，共同提高！</p>
<p>Objective-C/Swift技术开发交流群201556264，讨论何种技术并不受限，欢迎各位大牛百家争鸣！</p>
<p><a href="http://www.ggteach.com/index.html" target="_blank" rel="external">刚刚在线工作室</a>，欢迎关注或提出建设性意见！</p>
<p><a href="http://bbs.ggteach.com" target="_blank" rel="external">刚刚在线论坛</a>, 欢迎踊跃提问或解答！</p>
<p>如有转载，请注明出处，谢谢！</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/证书，Application-Loader/">证书，Application Loader</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/OC/">OC</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-如何发布自己的开源框架到CocoaPods" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/04/如何发布自己的开源框架到CocoaPods/" class="article-date">
  	<time datetime="2016-03-03T16:00:00.000Z" itemprop="datePublished">2016-03-04</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/04/如何发布自己的开源框架到CocoaPods/">如何发布自己的开源框架到CocoaPods</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="http://music.163.com/outchain/player?type=2&id=5023390&auto=0&height=66"></iframe>

<p>现在iOS开发过程中Cocoapods已经用的很普遍了，可以很方便的将第三方框架加到自己的项目中。现在也有个第三方的Cocoapods的插件，下载链接:<a href="https://github.com/ChinaFishNews/cocoapods-xcode-plugin.git" target="_blank" rel="external">https://github.com/ChinaFishNews/cocoapods-xcode-plugin.git</a>  安装好后是这样的</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-04-01.png?attname=" alt=""></p>
<p>还有个管理插件的插件Alcatraz，下载地址:<a href="https://github.com/ChinaFishNews/Alcatraz.git" target="_blank" rel="external">https://github.com/ChinaFishNews/Alcatraz.git</a>  安装好后是这样的</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-04-02.png?attname=" alt=""></p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-04-03.png?attname=" alt=""></p>
<p>通过Alcatraz可以随意安装很多插件，但是一些插件和当前的Xcode版本有时并不兼容，会导致卡慢、崩溃或者不起作用。这时候可以随意卸载</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-04-04.png?attname=" alt=""></p>
<p>目前安装了十多个插件，包括XAlign、Activate Power Mode、VVDocumenter、MacVim等十多个插件，感觉的确更便利于开发，更重要的是，不经意间一些很高大上的效果或动作在产品、测试面前装逼基本会得到满分。</p>
<p>如果我们想把自己写的组件或者库，甚至一个类开源出去，让别人也可以通过Cocoapods安装我们写的框架该怎么做呢？接下来和大家演示一下如何上传到Cocoapods上。</p>
<p>这里以我的一个Demo为例，cd到项目根目录，创建Podspec文件,UIImageDemo为项目名<br><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod <span class="operator">spec</span> create UIImageDemo</span><br></pre></td></tr></table></figure></p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-04-05.png?attname=" alt=""></p>
<p>打开podspec文件基本是这样的</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-04-06.png?attname=" alt=""></p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-04-07.png?attname=" alt=""></p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-04-08.png?attname=" alt=""></p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-04-09.png?attname=" alt=""></p>
<p>不需要填写的可以前面加个#注掉。</p>
<p>需要填写的大概有这几项<br>s.name ,是库的名称</p>
<p>s.version是库源代码版本号，项目提交到github上时需要给项目加个标签，这个标签要和这个 version一致，注意，版本号前面不需要加v</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-04-10.png?attname=" alt=""></p>
<p>用到的命令是<br><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">git add .</span><br><span class="line">git commit -m<span class="string">"test"</span></span><br><span class="line">git <span class="keyword">tag</span> </span><br><span class="line"><span class="title">git</span> push --tags</span><br><span class="line">git push origin <span class="literal">master</span></span><br></pre></td></tr></table></figure></p>
<p>s.summary是对库的简要概述</p>
<p>s.homepage是库的主页，我在这里填写的是github的链接(<a href="https://github.com/ChinaFishNews/UIImageDemo.git" target="_blank" rel="external">https://github.com/ChinaFishNews/UIImageDemo.git</a>)</p>
<p>s.license是许可文件，这里填”MIT”</p>
<p>s.author是库的作者</p>
<p>s.platform是库所支持的软件平台</p>
<p>s.source是声明原代码的地址，我这里也是填写的github链接,tag和上述的version要一致</p>
<p>s.source_files，声明了库中源代码的位置，前面的Classes可以去掉，我这里填的是”UIImageDemo/UIImageDemo/UIImageFactory.{.h,.m}”,{.h,m}匹配所有以.h和.m为扩展名的文件，我是把UIImageFactory这个类提交到Cocoapods上，项目目录如下所示</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-04-11.png?attname=" alt=""></p>
<p>s.exclude_files 这里没有用到，注掉就好</p>
<p>s.framework是依赖的核心库，我这只用了UIKit,如果有用到其他的库，可以用s.frameworks = @”aaa.framework”,@”bbb.framework”</p>
<p>s.dependency是填写依赖的库，没有的话注释掉就好。</p>
<p>填写完后，保存退出，需要验证这个文件是否可用，有任何的warning或者errror都不可以，验证命令:<br><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod <span class="operator">spec</span> lint UIImageDemo.podspec</span><br></pre></td></tr></table></figure></p>
<p>UIImageDemo换成你们自己的名字。我在这里尝试了多次都是失败，如下图所示</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-04-12.png?attname=" alt=""></p>
<p>这个错是因为cocoapods不是最新版本，需更新到最新版本，如下图所示</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-04-14.png?attname=" alt=""></p>
<p>步骤如下，先输入下面命令<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem sources <span class="operator">-l</span></span><br></pre></td></tr></table></figure></p>
<p>结果若为<br><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gem sources -l</span><br><span class="line"><span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span> CURRENT SOURCES <span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line"></span><br><span class="line">http://ruby.taobao.org/</span><br></pre></td></tr></table></figure></p>
<p>说明之前我替换过，若没有更改过gem source应该结果为<br><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">gem sources -l</span><br><span class="line"><span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span> CURRENT SOURCES <span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line"></span><br><span class="line">https://rubygems.org/</span><br></pre></td></tr></table></figure></p>
<p>或者<br><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ gem sources -l</span><br><span class="line"><span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span> CURRENT SOURCES <span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line"></span><br><span class="line">http://rubygems.org/</span><br></pre></td></tr></table></figure></p>
<p>现在淘宝ruby的源现在改成https的了,更换操作如下</p>
<p>移除操作（移除当前你查询到的gem source）<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem sources --remove <span class="string">http:</span><span class="comment">//ruby.taobao.org/</span></span><br></pre></td></tr></table></figure></p>
<p>执行结果为<br><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="label">http:</span>//ruby.taobao<span class="preprocessor">.org</span>/ removed from sources</span><br></pre></td></tr></table></figure></p>
<p>添加操作<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem sources -<span class="tag">a</span> https:<span class="comment">//ruby.taobao.org/</span></span><br></pre></td></tr></table></figure></p>
<p>执行结果为<br><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http<span class="variable">s:</span>//<span class="keyword">ruby</span>.taobao.org/ added <span class="keyword">to</span> sources</span><br></pre></td></tr></table></figure></p>
<p>再查询<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem sources <span class="operator">-l</span></span><br></pre></td></tr></table></figure></p>
<p>结果已经发生变化<br><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span> CURRENT SOURCES <span class="keyword">*</span><span class="keyword">*</span><span class="keyword">*</span></span><br><span class="line"></span><br><span class="line">https://ruby.taobao.org/</span><br></pre></td></tr></table></figure></p>
<p>然后更新<br><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo gem <span class="keyword">install</span> cocoapods</span><br></pre></td></tr></table></figure></p>
<p>更新完毕，再次验证,没有错误，但是有个警告<br><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod <span class="operator">spec</span> lint UIImageDemo.podspec</span><br></pre></td></tr></table></figure></p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-04-13.png?attname=" alt=""></p>
<p>这个警告是说没有找到许可文件，我随便从其他第三方库中找到了这个License文件导入到项目目录中</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-04-16.png?attname=" alt=""></p>
<p>再次验证，UIImageDemo.podspec passed validation 终于验证通过</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-04-15.png?attname=" alt=""></p>
<p>如果把它作为私有库来使用，可以使用<code>pod &#39;ProjectName&#39;,:git=&gt;&quot;http://xxx.git&quot;</code>(把xxx替换为库的git地址)。这时候可以把podspec文件放到自己本机中，目录为~/.cocoapods/repos/master/Specs。</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-04-17.png?attname=" alt=""></p>
<p>这时候并没有UIImagDemo文件夹，需要自己创建，也没有json文件，这是之后传到Cocoapods trunk之后才生成的文件。然后搜索这个库就已经有了</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-04-18.png?attname=" alt=""></p>
<p>但是这个时候别人并不能通过Cocoapod搜索到这个库。2014年5月20日，CocoaPods不再接受向CocoaPods/Specs的pull request，官方的说法是为了安全考虑，防止每个人的pod被其他人修改，于是CocoaPods团队开发了trunk服务，这样每个人都是其发布的pod的owner，没有权限的人无法修改，这样更安全。在cocoapods使用了trunk服务后,这需要0.33以上的版本，可以通过pod –version查看当前版本，上文已讲如何更新cocoapods到最新版本。使用步骤如下</p>
<h6 id="u6CE8_u518CTrunk"><a href="#u6CE8_u518CTrunk" class="headerlink" title="注册Trunk"></a>注册Trunk</h6><figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod trunk <span class="keyword">register</span> your_email <span class="string">'your_name'</span> --description=<span class="string">'macbook pro'</span></span><br></pre></td></tr></table></figure>
<p>改成自己对应的邮箱和名字即可，会收到一封邮件，点击邮件链接验证，然后<br>可使用<code>pod trunk me</code>查看信息</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-04-20.png?attname=" alt=""></p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-04-19.png?attname=" alt=""></p>
<p>如果项目是多人维护，可以添加其他维护者`pod trunk add-owner her_name her_email,不过我并没有尝试。</p>
<p>最后在工程根目录下执行<code>pod trunk push</code>命令。pod trunk push 命令会首先验证本地的podspec文件(是否有错误)，之后会上传spec文件到trunk，最后会将你上传的podspec文件转换为需要的json文件。</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-04-21.png?attname=" alt=""></p>
<p>如图，即上传成功了，整个过程就结束了。以后有新版本只需要修改工程根目录下的podspec文件就行了，然后重新执行pod trunk push命令。这时候别人就可以通过cocoapods使用你的库了。</p>
<p>新建一个项目，创建podfile文件，<br><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">platform <span class="symbol">:ios</span>, <span class="string">"8.0"</span></span><br><span class="line"></span><br><span class="line">pod <span class="string">'UIImageDemo'</span></span><br></pre></td></tr></table></figure></p>
<p>这时候使用<code>pod install --verbose --no-repo-update</code>并不会成功，因为这个命令 不会更新本地仓库，需要使用<code>pod  install</code>才可以，下载到本地之后以后再次使用就可以使用<code>`pod install --verbose --no-repo-update</code>命令了。</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-04-22.png?attname=" alt=""></p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-04-23.png?attname=" alt=""></p>
<p>如果想删除已经上传到Cocoapods上的库，只需前往/Users/xinwen/.cocoapods/repos/master/Specs 目录下找到对应名字的文件夹删除即可。我只是删除本地对应文件，但是pod search就搜索不到了，看来这应该是本地搜索。但是pod install 也安装不了，有些奇怪。在别人的电脑上，这个库对应的文件还在，还是可以继续使用，这时候如果不想别人继续使用，只能去github上把对应的源删了。关于删除这一点还有些许疑惑，后续有时间再留意下！</p>
<p>整个流程如下</p>
<blockquote>
<ul>
<li><p>上传至github时，给项目打个tag</p>
</li>
<li><p>到项目根目录创建podspec文件 命令:<code>pod spec create name</code> </p>
</li>
<li><p>验证podsepc文件  命令:<code>pod spec lint name.podspec</code></p>
</li>
<li><p>注册pod trunk  命令:<code>pod trunk register your_email  &#39;your_name&#39; --description=&#39;macbook pro</code></p>
</li>
<li><p>发布到pod trunk 命令: <code>pod trunk push</code></p>
</li>
<li><p>更新pod库 命令:<code>pod setup</code>  如果pod trunk push成功后无法pod search到自己的库，需要执行该命令。</p>
</li>
</ul>
</blockquote>
<p>以上，流程参考了网上的一篇上传HUPhotoBrowser的文章，过程中遇到不少问题，但是也的确很受帮助，感谢！</p>
<p>还是得感慨一下，这写博客的时间比我自己操作的时间还要长，心塞！</p>
<hr>
<p>如有任何疑问或问题请联系我:fishnewsdream@gmail.com,欢迎交流，共同提高！</p>
<p>Objective-C/Swift技术开发交流群201556264，讨论何种技术并不受限，欢迎各位大牛百家争鸣！</p>
<p><a href="http://www.ggteach.com/index.html" target="_blank" rel="external">刚刚在线工作室</a>，欢迎关注或提出建设性意见！</p>
<p><a href="http://bbs.ggteach.com" target="_blank" rel="external">刚刚在线论坛</a>, 欢迎踊跃提问或解答！</p>
<p>如有转载，请注明出处，谢谢！</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Cocoapods/">Cocoapods</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/进阶/">进阶</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-UI分析工具Reveal的使用" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/03/UI分析工具Reveal的使用/" class="article-date">
  	<time datetime="2016-03-02T16:00:00.000Z" itemprop="datePublished">2016-03-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/03/UI分析工具Reveal的使用/">UI分析工具Reveal的使用</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="http://music.163.com/outchain/player?type=2&id=5023390&auto=0&height=66"></iframe>

<p>官网下载地址: <a href="http://revealapp.com" target="_blank" rel="external">http://revealapp.com</a> (试用期30天)</p>
<p>在真正玩这个之前，听到了很多对Reveal的褒奖，不需要重写代码可以改变用户页面，实时修改页面布局,查看任意APP的UI等。</p>
<p>只是想感受一下的话，可以简单的集成一下。下载安装好后打开</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-03-12.png?attname=" alt=""></p>
<p>将Reveal.framework导入项目，并需要添加libz.tbd库，在Other Linker Flags项增加Any iOS Simulator SDK项</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-03-11.png?attname=" alt=""></p>
<p>使用模拟器和真机都可以，但是使用真机的话需要和电脑处在同一网络环境下。</p>
<p>然后使用模拟器运行项目，打开Reveal</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-03-13.png?attname=" alt=""></p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016_20_01.png?attname=" alt=""></p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-03-14.png?attname=" alt=""></p>
<p>上图左侧就是目录结构，中间是UI展示，右侧是类似于Xcode右侧的导航展示，可随意修改，并且会让模拟器的UI一并修改，虽然再次运行会恢复。</p>
<p>虽然Xcode自带有Debug View Hierarchy,但是相对较弱。在Reveal虽然可以修改UI但是感觉也不是很方便，也可能是因为接触不多没接触到精髓，但是使用Reveal来查看UI层次结构的确更为方便，尤其是刚接手一个新的项目，点击控件的同时会显示对应的类和相关的值。</p>
<p>因为试用期30天，网上有看到延长试用时间的方法，是进入~/Library/Preferences/这个目录，打开com.ittybittyapps.Reveal.plist文件，删除IBAApplicationPersistenceData这一项。然后再打开Reveal,会在右上角看到试用提示，再次变成30天。这只是延长使用时间，没能真正破解。还可以修改电脑上的系统时间，设为之前的时间，再次打开也可以继续使用，但是每次都要修改时间再改回来觉得比较麻烦，希望能找到好的破解方法。</p>
<p>有人研究出了用Reveal来观看任意app的UI方法，这个属于逆向工程的范畴了，也是接下来需要研究的课题！</p>
<h4 id="u7F51_u4E0A_u7684_u53E6_u5916_u4E00_u79CD_u96C6_u6210_u65B9_u6CD5_u662F"><a href="#u7F51_u4E0A_u7684_u53E6_u5916_u4E00_u79CD_u96C6_u6210_u65B9_u6CD5_u662F" class="headerlink" title="网上的另外一种集成方法是"></a>网上的另外一种集成方法是</h4><h6 id="u5728_u5F53_u524D_u7528_u6237_u76EE_u5F55_u65B0_u5EFA_u4E00_u4E2A_u6587_u4EF6-lldbinit_uFF0C_u4F4D_u4E8E_7E/-lldbinit_uFF0CLLDB_u6BCF_u6B21_u542F_u52A8_u7684_u65F6_u5019_u90FD_u4F1A_u52A0_u8F7D_u8FD9_u4E2A_u6587_u4EF6"><a href="#u5728_u5F53_u524D_u7528_u6237_u76EE_u5F55_u65B0_u5EFA_u4E00_u4E2A_u6587_u4EF6-lldbinit_uFF0C_u4F4D_u4E8E_7E/-lldbinit_uFF0CLLDB_u6BCF_u6B21_u542F_u52A8_u7684_u65F6_u5019_u90FD_u4F1A_u52A0_u8F7D_u8FD9_u4E2A_u6587_u4EF6" class="headerlink" title="在当前用户目录新建一个文件.lldbinit，位于~/.lldbinit，LLDB每次启动的时候都会加载这个文件"></a>在当前用户目录新建一个文件.lldbinit，位于~/.lldbinit，LLDB每次启动的时候都会加载这个文件</h6><h6 id="u5728-lldbinit_u4E2D_u8F93_u5165_u5982_u4E0B_u5185_u5BB9"><a href="#u5728-lldbinit_u4E2D_u8F93_u5165_u5982_u4E0B_u5185_u5BB9" class="headerlink" title="在.lldbinit中输入如下内容"></a>在.lldbinit中输入如下内容</h6><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">command alias reveal_load_sim <span class="title">expr</span> <span class="params">(<span class="keyword">void</span>*)</span><span class="title">dlopen</span><span class="params">(<span class="string">"/Applications/Reveal.app/Contents/SharedSupport/iOS-Libraries/libReveal.dylib"</span>, <span class="number">0x2</span>)</span></span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">command alias reveal_load_dev expr <span class="list">(<span class="keyword">void*</span>)</span>dlopen<span class="list">([<span class="list">(<span class="keyword">NSString*</span>)</span>[<span class="list">(<span class="keyword">NSBundle*</span>)</span>[NSBundle mainBundle] pathForResource:@<span class="string">"libReveal"</span> ofType:@<span class="string">"dylib"</span>] cStringUsingEncoding:<span class="number">0</span>x4], <span class="number">0</span>x2)</span><span class="comment">;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">command alias reveal_start expr (<span class="keyword">void</span>)[(<span class="built_in">NSNotificationCenter</span>*)[<span class="built_in">NSNotificationCenter</span> defaultCenter] postNotificationName:<span class="string">@"IBARevealRequestStart"</span> object:<span class="literal">nil</span>];</span><br></pre></td></tr></table></figure>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">command alias reveal_stop expr (<span class="keyword">void</span>)[(<span class="built_in">NSNotificationCenter</span>*)[<span class="built_in">NSNotificationCenter</span> defaultCenter] postNotificationName:<span class="string">@"IBARevealRequestStop"</span> object:<span class="literal">nil</span>];</span><br></pre></td></tr></table></figure>
<p>上述文件创建了4个命令：reveal_load_sim,reveal_load_dev, reveal_start 和 reveal_stop</p>
<blockquote>
<ul>
<li><p>reveal_load_sim 这个只在iOS模拟器上有效。它从Reveal的应用程序bundle中找到并加载libReveal.dylib（请确保你把Reveal安装到了系统的Application文件夹，如果你换地方了，你修改上述的文件）。</p>
</li>
<li><p>reveal_load_dev 这个命令在iOS设备和模拟器上都有效。不过，它需要你在Build Phase中的的Copy Bundle Resources中加上libReveal.dylib，请确保没有放到Link Binary With Libraries这个地方。</p>
</li>
<li><p>reveal_start 这个命令发出一个通知启动Reveal Server。</p>
</li>
<li><p>reveal_stop 这个命令发出一个通知停止Reveal Server。</p>
</li>
</ul>
</blockquote>
<p>打开工程后，在appdeleget中的didfinished：方法中打下断点，并按下图编辑断点,重新运行下应用即可</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-03-15.png?attname=" alt=""></p>
<p>Reveal也可以在真机调试中链接真机，需要在上图将reveal_load_sim改为reveal_load_dev,并且需要将reveal的动态链接库一并添加进工程中:</p>
<blockquote>
<ul>
<li><p>点击revel菜单的”help-&gt;show reveal library in finder”在finder中查找reveal的动态链接库：libReveal.dylib，并将其拖入工程</p>
</li>
<li><p>然后调整libReveal.dylib的引用方式，需要将libReveal.dylib文件拷贝到Sandbox中，但是我们通常在引入libReveal.dylib的时候Xcode默认是以Link Binary With Libraries的方式的，实际上应该是Copy Bundle Resources,所以应该先将libReveal.dylib从Link Binary With Libraries中移除掉，然后在Copy Bundle Resources中添加。</p>
</li>
</ul>
</blockquote>
<hr>
<p>如有任何疑问或问题请联系我:fishnewsdream@gmail.com,欢迎交流，共同提高！</p>
<p>Objective-C/Swift技术开发交流群201556264，讨论何种技术并不受限，欢迎各位大牛百家争鸣！</p>
<p><a href="http://www.ggteach.com/index.html" target="_blank" rel="external">刚刚在线工作室</a>，欢迎关注或提出建设性意见！</p>
<p><a href="http://bbs.ggteach.com" target="_blank" rel="external">刚刚在线论坛</a>, 欢迎踊跃提问或解答！</p>
<p>如有转载，请注明出处，谢谢！</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Reveal/">Reveal</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/OC/">OC</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Hexo博客托管在Coding上" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/03/Hexo博客托管在Coding上/" class="article-date">
  	<time datetime="2016-03-02T16:00:00.000Z" itemprop="datePublished">2016-03-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/03/Hexo博客托管在Coding上/">Hexo博客托管在Coding上</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="http://music.163.com/outchain/player?type=2&id=5023390&auto=0&height=66"></iframe>

<p>昨天GitCafe官网上发布声明，截至2016年5月31日停止所有服务，届时上面的资料和项目都将被永久删除，需要尽快将资料和项目迁移至Coding,只是因为被Coding收购了。操了个蛋，之前的博客就是托管在GitCafe上和GitHub上的，好在还有GitHub做后盾，不用太担心。虽然会一直服务到5月31号，不过还是决定将 博客迁移到Coding上。</p>
<p>前面的一些安装步骤就此省略，和托管在GitCafe和GitHub上的步骤一样，如果不太清楚可以参考之前的博文，之前已经安装了则可直接进行下面的步骤。</p>
<p>到Coding.net官网创建一个项目，名字可以随意，不过我还是创建了一个和用户名一样的项目名。</p>
<p>然后到Hexo的安装目录中打开_cinfig.yml文件，找到<code>deploy</code>项，按如下修改<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">deploy</span>:</span><br><span class="line">  <span class="attribute">type</span>: git</span><br><span class="line">  <span class="attribute">repo</span>: </span><br><span class="line">      <span class="attribute">github</span>: git<span class="variable">@github</span>.<span class="attribute">com</span>:ChinaFishNews/ChinaFishNews.github.io.git</span><br><span class="line">      <span class="attribute">coding</span>: <span class="attribute">https</span>:<span class="comment">//git.coding.net/ChinaFish/ChinaFish.git</span></span><br></pre></td></tr></table></figure></p>
<p>我还是将博客同时托管在Coding和GitHub两个平台上，无他，只因更相信GitHub。这里面的<code>ChinaFish</code>和<code>ChinaFishNews</code>都是第一个是用户名，第二个是项目名，之前的设置是<br><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">deploy</span>:</span><br><span class="line">  <span class="attribute">type</span>: git</span><br><span class="line">  <span class="attribute">repo</span>: </span><br><span class="line">      <span class="attribute">github</span>: git<span class="variable">@github</span>.<span class="attribute">com</span>:ChinaFishNews/ChinaFishNews.github.io.git</span><br><span class="line">     # <span class="attribute">gitcafe</span>: git<span class="variable">@gitcafe</span>.<span class="attribute">com</span>:ChinaFishNews/ChinaFishNews.git,gitcafe-pages</span><br></pre></td></tr></table></figure></p>
<p>可惜GitCafe被收购了。</p>
<p>然后打开终端使用下面命令push到仓库<br><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title">hexo</span> generate</span><br><span class="line"></span><br><span class="line">hexo deploy</span><br></pre></td></tr></table></figure></p>
<p>这一步可能会报错 ERROR Deployer not found: git  使用如下命令</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm <span class="operator"><span class="keyword">install</span> hexo-deployer-git <span class="comment">--save</span></span></span><br></pre></td></tr></table></figure>
<p>然后回到Coding的仓库下面进行如下配置</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-03-01.png?attname=" alt=""></p>
<p>按照如图，点击检测，会提醒没有检测到环境，不过直接点强制开启就可以了</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-03-02.png?attname=" alt=""></p>
<p>访问域名这一项可以随意填写，应用内存选的稍微大一些，点击显示高级选项</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-03-03.png?attname=" alt=""></p>
<p>将运行环境设置为Html,没设置前在部署的时候会导致失败。其他的不用填写，点击一键部署，可能会部署失败。如果部署失败可以查看日志或者查看常见部署问题解答。至此，配置就结束了，可以使用<code>chinafishnews.coding.io</code>访问博客了，<code>chinafishnews</code>是刚才填写的域名。</p>
<p>但是这样的话，每次写文章发布后都需要手动到这里部署，比较麻烦。可以使用<code>webhook</code>来自动部署。如下图所示</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-03-04.png?attname=" alt=""></p>
<p>点击新建Hook</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-03-05.png?attname=" alt=""></p>
<p>上面 的输入框中是填你的博客域名，也就是前面部署的时候那个域名地址，然后在后面加上/_</p>
<p>下面的输入框是输入token,直接填写<code>{ {TOKEN} }</code>就可以了</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-03-06.png?attname=" alt=""></p>
<p>然后点击环境变量，变量名填WEBHOOK_TOKEN,值为<code>{ {TOKEN} }</code>。然后回到控制台重新启动应用就可以了。这样就实现了自动部署。</p>
<p>另外，之前的域名指向的是GitCafe，现在被Coding收购，GitCafe的功能激也都基本被保留，只是需要重新解析域名，但是，也有一些改动。如下图添加域名</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-05-01.png?attname=" alt=""></p>
<p><b>注意<b>，部署分支的coding-pages需改成master,这是因为Hexo中_config.yml文件中的的coding源默认是master。否则无法成功。</b></b></p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-05-02.png?attname=" alt=""></p>
<p>然后到阿里云重新解析域名</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-05-03.png?attname=" alt=""></p>
<p>注意，gitcafe中填写的是chinafishnews.gitcafe.io,<code>chinafishnews</code>是gitcafe上自己的用户名，而coding上需改成ChinaFish.coding.me,<code>chinafish</code>是coding上自己的用户名，上图中也有提示已经绑定的域名(CNAME记录指向ChinaFish.coding.me)，稍等片刻便可以使用chinafish.news访问博客了。</p>
<hr>
<p>如有任何疑问或问题请联系我:fishnewsdream@gmail.com,欢迎交流，共同提高！</p>
<p>Objective-C/Swift技术开发交流群201556264，讨论何种技术并不受限，欢迎各位大牛百家争鸣！</p>
<p><a href="http://www.ggteach.com/index.html" target="_blank" rel="external">刚刚在线工作室</a>，欢迎关注或提出建设性意见！</p>
<p><a href="http://bbs.ggteach.com" target="_blank" rel="external">刚刚在线论坛</a>, 欢迎踊跃提问或解答！</p>
<p>如有转载，请注明出处，谢谢！</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Coding-net/">Coding.net</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/进阶/">进阶</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Markdown在线编辑" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/03/Markdown在线编辑/" class="article-date">
  	<time datetime="2016-03-02T16:00:00.000Z" itemprop="datePublished">2016-03-03</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/03/Markdown在线编辑/">Markdown在线编辑</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="http://music.163.com/outchain/player?type=2&id=5023390&auto=0&height=66"></iframe>

<p>MarkDwon是一种轻量级的标记语法，容易排版，可轻松转化为Pdf、Html格式文件，支持MarkDwon的编辑器有很多，包括像Markdown Pro、Mou、MacDwon、MacHub等等。</p>
<p>提供一个Markdown Pro的下载地址:<a href="http://pan.baidu.com/s/1c0Pk4oS" target="_blank" rel="external">http://pan.baidu.com/s/1c0Pk4oS</a> 密码:sehk</p>
<p>如何编辑使用呢?</p>
<p>在此提供两个官方案例:</p>
<p><a href="https://www.zybuluo.com/mdeditor#fn:code" target="_blank" rel="external">https://www.zybuluo.com/mdeditor#fn:code</a> 和</p>
<p><a href="https://www.zybuluo.com/mdeditor#fn:code" target="_blank" rel="external">https://www.zybuluo.com/mdeditor#fn:code</a></p>
<p>模仿案例上的格式基本迅速就可以掌握使用方法</p>
<p>里面用到的图片，我是上传到七牛云存储上，之前尝试过上传到百度云或者直接放在当前目录下，有时并不能显示成功，放在七牛云上下载显示的很快，基本没出现过问题。</p>
<hr>
<p>如有任何疑问或问题请联系我:fishnewsdream@gmail.com,欢迎交流，共同提高！</p>
<p>Objective-C/Swift技术开发交流群201556264，讨论何种技术并不受限，欢迎各位大牛百家争鸣！</p>
<p><a href="http://www.ggteach.com/index.html" target="_blank" rel="external">刚刚在线工作室</a>，欢迎关注或提出建设性意见！</p>
<p><a href="http://bbs.ggteach.com" target="_blank" rel="external">刚刚在线论坛</a>, 欢迎踊跃提问或解答！</p>
<p>如有转载，请注明出处，谢谢！</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MarkDown、Mou、Macdown/">MarkDown、Mou、Macdown</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/进阶/">进阶</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-UIImage的相关操作" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/01/UIImage的相关操作/" class="article-date">
  	<time datetime="2016-02-29T16:00:00.000Z" itemprop="datePublished">2016-03-01</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/01/UIImage的相关操作/">UIImage的相关操作</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="http://music.163.com/outchain/player?type=2&id=5023390&auto=0&height=66"></iframe>

<p>最近看了下JSQMessage的源码，一个比较优雅的UI库，代码很赞，只用了少量的图片，牵扯了一些UIImage的相关操作。虽然控件比较基本 ，但是一些用法还是不是很清楚，希望接下来能有时间去整理下其他的基础控件。此次仅为UIImage的一些相关操作。</p>
<p>Github下载地址: <a href="https://github.com/ChinaFishNews/UIImageDemo" target="_blank" rel="external">https://github.com/ChinaFishNews/UIImageDemo</a></p>
<h4 id="u901A_u8FC7_u989C_u8272_u751F_u6210_u7EAF_u8272_u56FE_u7247"><a href="#u901A_u8FC7_u989C_u8272_u751F_u6210_u7EAF_u8272_u56FE_u7247" class="headerlink" title="通过颜色生成纯色图片"></a>通过颜色生成纯色图片</h4><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">+(<span class="built_in">UIImage</span> *)imageWithColor:(<span class="built_in">UIColor</span> *)color</span><br><span class="line">                  withSize:(<span class="built_in">CGSize</span>)size&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">CGRect</span> rect = <span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, size<span class="variable">.width</span>, size<span class="variable">.height</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">UIGraphicsBeginImageContext</span>(rect<span class="variable">.size</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">CGContextRef</span> context = <span class="built_in">UIGraphicsGetCurrentContext</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">CGContextSetFillColorWithColor</span>(context, [color <span class="built_in">CGColor</span>]);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">CGContextFillRect</span>(context, rect);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">UIImage</span> *image = <span class="built_in">UIGraphicsGetImageFromCurrentImageContext</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">UIGraphicsEndImageContext</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> image;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="u901A_u8FC7_u56FE_u7247_u751F_u6210_u5706_u5F62_u56FE_u7247"><a href="#u901A_u8FC7_u56FE_u7247_u751F_u6210_u5706_u5F62_u56FE_u7247" class="headerlink" title="通过图片生成圆形图片"></a>通过图片生成圆形图片</h4><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">+(<span class="built_in">UIImage</span> *)circualImage:(<span class="built_in">UIImage</span> *)image</span><br><span class="line">            withDiameter:(<span class="built_in">NSUInteger</span>)diameter&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">CGRect</span> frame = <span class="built_in">CGRectMake</span>(<span class="number">0.0</span>f, <span class="number">0.0</span>f, diameter, diameter);</span><br><span class="line">    <span class="built_in">UIImage</span> *newImage = <span class="literal">nil</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">UIGraphicsBeginImageContextWithOptions</span>(frame<span class="variable">.size</span>, <span class="literal">NO</span>, [<span class="built_in">UIScreen</span> mainScreen]<span class="variable">.scale</span>);</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">UIBezierPath</span> *imgPath = [<span class="built_in">UIBezierPath</span> bezierPathWithOvalInRect:frame];</span><br><span class="line">        [imgPath addClip];</span><br><span class="line">        [image drawInRect:frame];</span><br><span class="line">        </span><br><span class="line">        newImage = <span class="built_in">UIGraphicsGetImageFromCurrentImageContext</span>();</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">UIGraphicsEndImageContext</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> newImage;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="u901A_u8FC7_u56FE_u7247_u6216_u989C_u8272_u751F_u6210_u5706_u5F62_u56FE_u7247_28_u5982_u4F20_u5165_u989C_u8272_u5219_u901A_u8FC7_u989C_u8272_u751F_u6210_29"><a href="#u901A_u8FC7_u56FE_u7247_u6216_u989C_u8272_u751F_u6210_u5706_u5F62_u56FE_u7247_28_u5982_u4F20_u5165_u989C_u8272_u5219_u901A_u8FC7_u989C_u8272_u751F_u6210_29" class="headerlink" title="通过图片或颜色生成圆形图片(如传入颜色则通过颜色生成)"></a>通过图片或颜色生成圆形图片(如传入颜色则通过颜色生成)</h4><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">+(<span class="built_in">UIImage</span> *)circualarImage:(<span class="built_in">UIImage</span> *)image</span><br><span class="line">              withDiameter:(<span class="built_in">NSUInteger</span>)diameter</span><br><span class="line">          highlightedColor:(<span class="built_in">UIColor</span> *)highlightedColor&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">CGRect</span> frame = <span class="built_in">CGRectMake</span>(<span class="number">0.0</span>f, <span class="number">0.0</span>f, diameter, diameter);</span><br><span class="line">    <span class="built_in">UIImage</span> *newImage = <span class="literal">nil</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">UIGraphicsBeginImageContextWithOptions</span>(frame<span class="variable">.size</span>, <span class="literal">NO</span>, [<span class="built_in">UIScreen</span> mainScreen]<span class="variable">.scale</span>);</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">CGContextRef</span> context = <span class="built_in">UIGraphicsGetCurrentContext</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">UIBezierPath</span> *imgPath = [<span class="built_in">UIBezierPath</span> bezierPathWithOvalInRect:frame];</span><br><span class="line">        [imgPath addClip];</span><br><span class="line">        [image drawInRect:frame];</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (highlightedColor != <span class="literal">nil</span>) &#123;</span><br><span class="line">            <span class="built_in">CGContextSetFillColorWithColor</span>(context, highlightedColor<span class="variable">.CGColor</span>);</span><br><span class="line">            <span class="built_in">CGContextFillEllipseInRect</span>(context, frame);</span><br><span class="line">        &#125;</span><br><span class="line">        newImage = <span class="built_in">UIGraphicsGetImageFromCurrentImageContext</span>();</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">UIGraphicsEndImageContext</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> newImage;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="u5728_u5DF2_u6709_u56FE_u7247_u4E0A_u6DFB_u52A0_u6587_u5B57"><a href="#u5728_u5DF2_u6709_u56FE_u7247_u4E0A_u6DFB_u52A0_u6587_u5B57" class="headerlink" title="在已有图片上添加文字"></a>在已有图片上添加文字</h4><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">+(<span class="built_in">UIImage</span> *)addTextInImage:(<span class="built_in">UIImage</span> *)image</span><br><span class="line">                     text:(<span class="built_in">NSString</span> *)text</span><br><span class="line">                textColor:(<span class="built_in">UIColor</span> *)textColor</span><br><span class="line">                     font:(<span class="built_in">UIFont</span> *)font&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">CGRect</span> frame = <span class="built_in">CGRectMake</span>(<span class="number">0.0</span>f, <span class="number">0.0</span>f, image<span class="variable">.size</span><span class="variable">.width</span>, image<span class="variable">.size</span><span class="variable">.height</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSDictionary</span> *attributes = @&#123; <span class="built_in">NSFontAttributeName</span> : [<span class="built_in">UIFont</span> systemFontOfSize:<span class="number">33</span>],</span><br><span class="line">                                  <span class="built_in">NSForegroundColorAttributeName</span> : textColor &#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">CGRect</span> textFrame = [text boundingRectWithSize:image<span class="variable">.size</span></span><br><span class="line">                                              options:(<span class="built_in">NSStringDrawingUsesLineFragmentOrigin</span> | <span class="built_in">NSStringDrawingUsesFontLeading</span>)</span><br><span class="line">                                           attributes:attributes</span><br><span class="line">                                              context:<span class="literal">nil</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">CGPoint</span> frameMidPoint = <span class="built_in">CGPointMake</span>(<span class="built_in">CGRectGetMidX</span>(frame), <span class="built_in">CGRectGetMidY</span>(frame));</span><br><span class="line">    <span class="built_in">CGPoint</span> textFrameMidPoint = <span class="built_in">CGPointMake</span>(<span class="built_in">CGRectGetMidX</span>(textFrame), <span class="built_in">CGRectGetMidY</span>(textFrame));</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">CGFloat</span> dx = frameMidPoint<span class="variable">.x</span> - textFrameMidPoint<span class="variable">.x</span>;</span><br><span class="line">    <span class="built_in">CGFloat</span> dy = frame<span class="variable">.size</span><span class="variable">.height</span> - textFrameMidPoint<span class="variable">.y</span>*<span class="number">2</span>;;</span><br><span class="line">    <span class="built_in">CGPoint</span> drawPoint = <span class="built_in">CGPointMake</span>(dx, dy);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">UIImage</span> *newImage = <span class="literal">nil</span>;</span><br><span class="line">    <span class="built_in">UIGraphicsBeginImageContext</span>(frame<span class="variable">.size</span>);</span><br><span class="line">    &#123;</span><br><span class="line">        [image drawInRect:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, frame<span class="variable">.size</span><span class="variable">.width</span>, frame<span class="variable">.size</span><span class="variable">.height</span>)];</span><br><span class="line">        </span><br><span class="line">        [text drawAtPoint:drawPoint withAttributes:attributes];</span><br><span class="line">        </span><br><span class="line">        newImage = <span class="built_in">UIGraphicsGetImageFromCurrentImageContext</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">UIGraphicsEndImageContext</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> newImage;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="u901A_u8FC7_u989C_u8272_u751F_u6210_u56FE_u7247_u5E76_u6DFB_u52A0_u6587_u5B57"><a href="#u901A_u8FC7_u989C_u8272_u751F_u6210_u56FE_u7247_u5E76_u6DFB_u52A0_u6587_u5B57" class="headerlink" title="通过颜色生成图片并添加文字"></a>通过颜色生成图片并添加文字</h4><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">+(<span class="built_in">UIImage</span> *)imageWithText:(<span class="built_in">NSString</span> *)text</span><br><span class="line">          backgroundColor:(<span class="built_in">UIColor</span> *)backgroundColor</span><br><span class="line">                textColor:(<span class="built_in">UIColor</span> *)textColor</span><br><span class="line">                     font:(<span class="built_in">UIFont</span> *)font</span><br><span class="line">                     size:(<span class="built_in">CGSize</span> )size&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">CGRect</span> frame = <span class="built_in">CGRectMake</span>(<span class="number">0.0</span>f, <span class="number">0.0</span>f, size<span class="variable">.width</span>, size<span class="variable">.height</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSDictionary</span> *attributes = @&#123; <span class="built_in">NSFontAttributeName</span> : font,</span><br><span class="line">                                  <span class="built_in">NSForegroundColorAttributeName</span> : textColor &#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">CGRect</span> textFrame = [text boundingRectWithSize:frame<span class="variable">.size</span></span><br><span class="line">                                              options:(<span class="built_in">NSStringDrawingUsesLineFragmentOrigin</span> | <span class="built_in">NSStringDrawingUsesFontLeading</span>)</span><br><span class="line">                                           attributes:attributes</span><br><span class="line">                                              context:<span class="literal">nil</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">CGPoint</span> frameMidPoint = <span class="built_in">CGPointMake</span>(<span class="built_in">CGRectGetMidX</span>(frame), <span class="built_in">CGRectGetMidY</span>(frame));</span><br><span class="line">    <span class="built_in">CGPoint</span> textFrameMidPoint = <span class="built_in">CGPointMake</span>(<span class="built_in">CGRectGetMidX</span>(textFrame), <span class="built_in">CGRectGetMidY</span>(textFrame));</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">CGFloat</span> dx = frameMidPoint<span class="variable">.x</span> - textFrameMidPoint<span class="variable">.x</span>;</span><br><span class="line">    <span class="built_in">CGFloat</span> dy = frameMidPoint<span class="variable">.y</span> - textFrameMidPoint<span class="variable">.y</span>;</span><br><span class="line">    <span class="built_in">CGPoint</span> drawPoint = <span class="built_in">CGPointMake</span>(dx, dy);</span><br><span class="line">    <span class="built_in">UIImage</span> *newimage = <span class="literal">nil</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">UIGraphicsBeginImageContextWithOptions</span>(frame<span class="variable">.size</span>, <span class="literal">NO</span>, [<span class="built_in">UIScreen</span> mainScreen]<span class="variable">.scale</span>);</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">CGContextRef</span> context = <span class="built_in">UIGraphicsGetCurrentContext</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">CGContextSetFillColorWithColor</span>(context, backgroundColor<span class="variable">.CGColor</span>);</span><br><span class="line">        <span class="built_in">CGContextFillRect</span>(context, frame);</span><br><span class="line">        [text drawAtPoint:drawPoint withAttributes:attributes];</span><br><span class="line">        </span><br><span class="line">        newimage = <span class="built_in">UIGraphicsGetImageFromCurrentImageContext</span>();</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">UIGraphicsEndImageContext</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> newimage;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="u56FE_u7247_u53E0_u52A0"><a href="#u56FE_u7247_u53E0_u52A0" class="headerlink" title="图片叠加"></a>图片叠加</h4><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">+(<span class="keyword">void</span>)maskView:(UIImageView *)imageView withImage:(UIImage *)<span class="built_in">image</span>&#123;</span><br><span class="line">    </span><br><span class="line">    UIImageView *imageViewMask = [[UIImageView alloc] initWithImage:<span class="built_in">image</span>];</span><br><span class="line">    imageViewMask.frame = CGRectMake(<span class="number">0</span>, <span class="number">0</span>, imageView.frame.<span class="built_in">size</span>.<span class="variable">width</span>, imageView.frame.<span class="built_in">size</span>.<span class="variable">height</span>);</span><br><span class="line"></span><br><span class="line">    imageView.layer.mask = imageViewMask.layer;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>或者使用另外一种方法<br><figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="typename">void</span>)<span class="string">drawRect:</span>(CGRect)rect &#123;</span><br><span class="line"></span><br><span class="line">    UIImage *imageOne = [UIImage <span class="string">imageNamed:</span>@<span class="string">"bubble_min"</span>];</span><br><span class="line">    UIImage *imageTwo = [UIImage <span class="string">imageNamed:</span>@<span class="string">"goldengate"</span>];</span><br><span class="line">    </span><br><span class="line">    [imageOne <span class="string">drawInRect:</span>rect];</span><br><span class="line">    [imageTwo <span class="string">drawInRect:</span>CGRectInset(rect, <span class="number">0.0</span>f, <span class="number">0.0</span>f) <span class="string">blendMode:</span>kCGBlendModeSourceIn <span class="string">alpha:</span><span class="number">1</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="u6C34_u5E73_u65CB_u8F6C_u56FE_u7247"><a href="#u6C34_u5E73_u65CB_u8F6C_u56FE_u7247" class="headerlink" title="水平旋转图片"></a>水平旋转图片</h4><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">+(UIImage <span class="variable">*)</span>horizontallyFlippedImageFromImage:(UIImage <span class="variable">*)</span><span class="keyword">image</span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> [UIImage imageWithCGImage:<span class="keyword">image</span>.CGImage</span><br><span class="line">                               <span class="keyword">scale</span>:<span class="keyword">image</span>.<span class="keyword">scale</span></span><br><span class="line">                         orientation:UIImageOrientationUpMirrored];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="u4FEE_u6539_u56FE_u7247_u989C_u8272"><a href="#u4FEE_u6539_u56FE_u7247_u989C_u8272" class="headerlink" title="修改图片颜色"></a>修改图片颜色</h4><p>   <b> //kCGBlendModeOverlay能保留灰度信息，kCGBlendModeDestinationIn能保留透明度信息<b><br><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">+ (UIImage *)imageColorChanged:(UIImage *)<span class="built_in">image</span></span><br><span class="line">                     tintColor:(UIColor *)tintColor</span><br><span class="line">                     <span class="built_in">blendMode</span>:(CGBlendMode)<span class="built_in">blendMode</span>&#123;</span><br><span class="line">    </span><br><span class="line">    UIGraphicsBeginImageContextWithOptions(<span class="built_in">image</span>.<span class="built_in">size</span>, NO, <span class="number">0.0</span>f);</span><br><span class="line">    [tintColor setFill];</span><br><span class="line">    CGRect bounds = CGRectMake(<span class="number">0</span>, <span class="number">0</span>, <span class="built_in">image</span>.<span class="built_in">size</span>.<span class="variable">width</span>, <span class="built_in">image</span>.<span class="built_in">size</span>.<span class="variable">height</span>);</span><br><span class="line">    UIRectFill(bounds);</span><br><span class="line">    </span><br><span class="line">    [<span class="built_in">image</span> drawInRect:bounds <span class="built_in">blendMode</span>:<span class="built_in">blendMode</span> <span class="built_in">alpha</span>:<span class="number">1.0</span>f];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">blendMode</span> != kCGBlendModeDestinationIn) &#123;</span><br><span class="line">        [<span class="built_in">image</span> drawInRect:bounds <span class="built_in">blendMode</span>:kCGBlendModeDestinationIn <span class="built_in">alpha</span>:<span class="number">1.0</span>f];</span><br><span class="line">    &#125;</span><br><span class="line">    UIImage *tintedImage = UIGraphicsGetImageFromCurrentImageContext();</span><br><span class="line">    UIGraphicsEndImageContext();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> tintedImage;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></b></b></p>
<p>方法使用:</p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-01-01.gif?attname=" alt=""></p>
<hr>
<p>如有任何疑问或问题请联系我:fishnewsdream@gmail.com,欢迎交流，共同提高！</p>
<p>Objective-C/Swift技术开发交流群201556264，讨论何种技术并不受限，欢迎各位大牛百家争鸣！</p>
<p><a href="http://www.ggteach.com/index.html" target="_blank" rel="external">刚刚在线工作室</a>，欢迎关注或提出建设性意见！</p>
<p><a href="http://bbs.ggteach.com" target="_blank" rel="external">刚刚在线论坛</a>, 欢迎踊跃提问或解答！</p>
<p>如有转载，请注明出处，谢谢！</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Core-Graphics/">Core Graphics</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/OC/">OC</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-iOS程序后台无限运行" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/01/iOS程序后台无限运行/" class="article-date">
  	<time datetime="2016-02-29T16:00:00.000Z" itemprop="datePublished">2016-03-01</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/01/iOS程序后台无限运行/">iOS程序后台无限运行</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="http://music.163.com/outchain/player?type=2&id=5023390&auto=0&height=66"></iframe>

<p>让我们的应用一直在后台运行不被系统kill掉，这种需求并不多见。在我呆的上家公司里，期间有段时间研究了很多稀奇古怪的问题，比如safari和app互通、监测当前手机打开哪些程序、监测手机app各自运行时间、程序一直运行不被系统杀死等等很多，当然有些并没有研究出结果，也许本来就实现不了。这个后台无限运行，想上App Store肯定是会被拒的，在用企业证书分发的app有些可能会用到，之前用到这个的场景是因为积分墙刷榜，这个程序要在后台一直运行，来监测其他app的行为，如注册、登陆、认证等，这就要这个app持续运行。鉴于苹果对iOS系统的封闭政策，我们的APP在进入后台能做的事情相对有限。一般只有几秒的时间留给用户进行一些清理和数据保存的时间，当然可以使用开启新任务向系统借点时间，但这时间也是有限的， 不会超过10分钟，10分钟后无论怎么向系统申请继续后台，系统会强制挂起App，挂起所有后台操作、线程，直到用户再次点击App之后才会继续运行。但是系统也预留了一些特殊应用可以实现真后台的方法，包括VoIP、GPS、Audio等。</p>
<p>这里使用了MMPDeepSleepPreventer类，这个类就是通过一直播放无声音乐来实现永久后台运行。一般来说在播放音乐的时候，如果打开其他播放音乐的应用，那之前的音乐就会被关闭，但是MMPDeepSleepPreventer这个类使用了定时器每5秒播放一次，所以不会被中断，除非手动kill掉项目。</p>
<p>下载链接:<a href="https://github.com/ChinaFishNews/MMPDeepSleepPreventer.git" target="_blank" rel="external">https://github.com/ChinaFishNews/MMPDeepSleepPreventer.git</a></p>
<p><img src="http://7xqjid.com1.z0.glb.clouddn.com/2016-03-02-01.png?attname=" alt=""></p>
<p>把上述问价导入项目，添加AVFoundation.framework、AudioToolbox.framework</p>
<p>在Info.plist中设置添加Required background modes键值，设置为App provides Voice over IP services</p>
<p>另外在Bulid Phases中将MMPDeepSleepPreventer.m类设置为-fno-objc-arc</p>
<p>然后需在AppDelegate中设置<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="id">#import</span> &lt;AVFoundation/AVFoundation.h&gt;</span><br><span class="line"><span class="id">#import</span> <span class="string">"MMPDeepSleepPreventer.h"</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MMPDeepSleepPreventer * soundBoard =  <span class="string">[MMPDeepSleepPreventer new]</span>;</span><br><span class="line"><span class="string">[soundBoard startPreventSleep]</span>;</span><br></pre></td></tr></table></figure>
<hr>
<p>如有任何疑问或问题请联系我:fishnewsdream@gmail.com,欢迎交流，共同提高！</p>
<p>Objective-C/Swift技术开发交流群201556264，讨论何种技术并不受限，欢迎各位大牛百家争鸣！</p>
<p><a href="http://www.ggteach.com/index.html" target="_blank" rel="external">刚刚在线工作室</a>，欢迎关注或提出建设性意见！</p>
<p><a href="http://bbs.ggteach.com" target="_blank" rel="external">刚刚在线论坛</a>, 欢迎踊跃提问或解答！</p>
<p>如有转载，请注明出处，谢谢！</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MMPDeepSleepPreventer-后台无限运行/">MMPDeepSleepPreventer,后台无限运行</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/进阶/">进阶</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-iOS开发使用AVPlayer、MoviePlayer播放本地、网络视频" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/02/28/iOS开发使用AVPlayer、MoviePlayer播放本地、网络视频/" class="article-date">
  	<time datetime="2016-02-27T16:00:00.000Z" itemprop="datePublished">2016-02-28</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/02/28/iOS开发使用AVPlayer、MoviePlayer播放本地、网络视频/">iOS开发使用AVPlayer、MoviePlayer播放本地、网络视频</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="http://music.163.com/outchain/player?type=2&id=5023390&auto=0&height=66"></iframe>


<p>Github下载地址: <a href="https://github.com/ChinaFishNews/VideoPlay.git" target="_blank" rel="external">https://github.com/ChinaFishNews/VideoPlay.git</a></p>
<p>Demo中使用的ALMoviePlayerController是一个框架，继承了系统的MPMoviePlayerController，做了一些扩展和封装 。</p>
<p>代码我就不过多解读了，相对是比较清晰的，仅是为了实现播放功能，虽然很简陋且还有一些问题。</p>
<p>其中在使用AVPlayer播放视频的时候滑动进度条稍微有些不灵敏，之前在做项目的时候因为是使用Swift语言实现的，所以功能没法直接拿出来，就用OC也勉强实现了这个功能。项目中的解决方法是通过在进度条上画了热点，判断当前点击的点或滑动停止的点占总长度的百分比，从而定位到正确的播放位置。代码如下:</p>
<p>画出热点<br><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">func drawHotField()</span><br><span class="line">&#123;</span><br><span class="line">    let width:<span class="built_in">CGFloat</span> = <span class="keyword">self</span><span class="variable">.view</span><span class="variable">.bounds</span><span class="variable">.size</span><span class="variable">.width</span></span><br><span class="line">    let height:<span class="built_in">CGFloat</span> = <span class="keyword">self</span><span class="variable">.view</span><span class="variable">.bounds</span><span class="variable">.size</span><span class="variable">.height</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">self</span><span class="variable">.buttonMaintain</span> = <span class="built_in">CGPathCreateMutable</span>()</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">self</span><span class="variable">.whetherPortrate</span> == <span class="literal">true</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">CGPathMoveToPoint</span>(buttonMaintain,<span class="literal">nil</span>, <span class="number">38</span>, height-<span class="number">60</span>)</span><br><span class="line">        <span class="built_in">CGPathAddLineToPoint</span>(buttonMaintain, <span class="literal">nil</span>, width-<span class="number">170</span>,  height-<span class="number">60</span>)</span><br><span class="line">        <span class="built_in">CGPathAddLineToPoint</span>(buttonMaintain, <span class="literal">nil</span>, width-<span class="number">170</span>,  height)</span><br><span class="line">        <span class="built_in">CGPathAddLineToPoint</span>(buttonMaintain, <span class="literal">nil</span>, <span class="number">38</span>, height)</span><br><span class="line">        <span class="built_in">CGPathCloseSubpath</span>(<span class="keyword">self</span><span class="variable">.buttonMaintain</span>)</span><br><span class="line">    &#125;<span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">CGPathMoveToPoint</span>(buttonMaintain,<span class="literal">nil</span>, <span class="number">60</span>, <span class="number">65</span>)</span><br><span class="line">        <span class="built_in">CGPathAddLineToPoint</span>(buttonMaintain, <span class="literal">nil</span>, <span class="number">60</span>,  height-<span class="number">150</span>)</span><br><span class="line">        <span class="built_in">CGPathAddLineToPoint</span>(buttonMaintain, <span class="literal">nil</span>, <span class="number">0</span>,  height-<span class="number">150</span>)</span><br><span class="line">        <span class="built_in">CGPathAddLineToPoint</span>(buttonMaintain, <span class="literal">nil</span>, <span class="number">0</span>,<span class="number">65</span> )</span><br><span class="line">        <span class="built_in">CGPathCloseSubpath</span>(<span class="keyword">self</span><span class="variable">.buttonMaintain</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    Logger<span class="variable">.info</span>(<span class="string">"pathPoint:  \(self.buttonMaintain)"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>点击<br><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">func controlViewClicked(tapGesture:UITapGestureRecognizer)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">self</span><span class="built_in">.</span>drawHotField()</span><br><span class="line">        Logger<span class="built_in">.</span>info(<span class="string">"tap:---------------"</span>)</span><br><span class="line">        <span class="keyword">let</span> tapPoint:CGPoint = tapGesture<span class="built_in">.</span>locationInView(<span class="built_in">self</span><span class="built_in">.</span>view)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> CGPathContainsPoint(<span class="built_in">self</span><span class="built_in">.</span>buttonMaintain,nil,tapPoint,<span class="literal">false</span>) == <span class="literal">true</span></span><br><span class="line">        &#123;</span><br><span class="line">             <span class="built_in">var</span> currentX = tapPoint<span class="built_in">.</span>x</span><br><span class="line">             <span class="built_in">var</span> percent = (currentX-<span class="number">38</span>)/<span class="built_in">self</span><span class="built_in">.</span>progessSlider<span class="subst">!</span><span class="built_in">.</span>frame<span class="built_in">.</span>size<span class="built_in">.</span>width</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">self</span><span class="built_in">.</span>whetherPortrate != <span class="literal">true</span></span><br><span class="line">            &#123;</span><br><span class="line">                currentX = tapPoint<span class="built_in">.</span>y</span><br><span class="line">                percent = (currentX-<span class="number">65</span>)/<span class="built_in">self</span><span class="built_in">.</span>progessSlider<span class="subst">!</span><span class="built_in">.</span>frame<span class="built_in">.</span>size<span class="built_in">.</span>width</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">let</span> <span class="built_in">duration</span>: CMTime = <span class="built_in">self</span><span class="built_in">.</span>player<span class="subst">!</span><span class="built_in">.</span>currentItem<span class="subst">!</span><span class="built_in">.</span><span class="built_in">duration</span></span><br><span class="line">            <span class="built_in">var</span> currentSecond: Float64 = CMTimeGetSeconds(<span class="built_in">duration</span>)</span><br><span class="line">            currentSecond = currentSecond * Float64(percent)</span><br><span class="line">            <span class="built_in">self</span><span class="built_in">.</span>progessSlider?<span class="built_in">.</span>value = Float( currentSecond / CMTimeGetSeconds(<span class="built_in">self</span><span class="built_in">.</span>player<span class="subst">!</span><span class="built_in">.</span>currentItem<span class="subst">!</span><span class="built_in">.</span><span class="built_in">duration</span>))</span><br><span class="line">            <span class="built_in">self</span><span class="built_in">.</span>player?<span class="built_in">.</span>currentItem<span class="subst">!</span><span class="built_in">.</span>seekToTime(CMTimeMakeWithSeconds(Float64(Float(CMTimeGetSeconds(<span class="built_in">duration</span>)) * <span class="built_in">self</span><span class="built_in">.</span>progessSlider<span class="subst">!</span><span class="built_in">.</span>value), Int32(CMTimeGetSeconds(<span class="built_in">duration</span>))))</span><br><span class="line">            <span class="built_in">self</span><span class="built_in">.</span>progressLabel?<span class="built_in">.</span>text = <span class="built_in">self</span><span class="built_in">.</span>getCurrentTime(currentSecond)</span><br><span class="line">            </span><br><span class="line">            <span class="built_in">self</span><span class="built_in">.</span>judgeWhetherEnd()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<p>滑动<br><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">func controlViewPaned(panGesture:UIPanGestureRecognizer)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">self</span><span class="built_in">.</span>drawHotField()</span><br><span class="line">        Logger<span class="built_in">.</span>info(<span class="string">"pan:---------------"</span>)</span><br><span class="line">        <span class="keyword">let</span> tapPoint:CGPoint = panGesture<span class="built_in">.</span>locationInView(<span class="built_in">self</span><span class="built_in">.</span>view)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> panGesture<span class="built_in">.</span>state == UIGestureRecognizerState<span class="built_in">.</span>Began <span class="subst">||</span> panGesture<span class="built_in">.</span>state == UIGestureRecognizerState<span class="built_in">.</span>Changed</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> CGPathContainsPoint(<span class="built_in">self</span><span class="built_in">.</span>buttonMaintain,nil,tapPoint,<span class="literal">false</span>) == <span class="literal">true</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">var</span> currentX = tapPoint<span class="built_in">.</span>x</span><br><span class="line">                <span class="built_in">var</span> percent = (currentX-<span class="number">38</span>)/<span class="built_in">self</span><span class="built_in">.</span>progessSlider<span class="subst">!</span><span class="built_in">.</span>frame<span class="built_in">.</span>size<span class="built_in">.</span>width</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">self</span><span class="built_in">.</span>whetherPortrate != <span class="literal">true</span></span><br><span class="line">                &#123;</span><br><span class="line">                    currentX = tapPoint<span class="built_in">.</span>y</span><br><span class="line">                    percent = (currentX-<span class="number">65</span>)/<span class="built_in">self</span><span class="built_in">.</span>progessSlider<span class="subst">!</span><span class="built_in">.</span>frame<span class="built_in">.</span>size<span class="built_in">.</span>width</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">let</span> <span class="built_in">duration</span>: CMTime = <span class="built_in">self</span><span class="built_in">.</span>player<span class="subst">!</span><span class="built_in">.</span>currentItem<span class="subst">!</span><span class="built_in">.</span><span class="built_in">duration</span></span><br><span class="line">                <span class="built_in">var</span> currentSecond: Float64 = CMTimeGetSeconds(<span class="built_in">duration</span>)</span><br><span class="line">                currentSecond = currentSecond * Float64(percent)</span><br><span class="line">                <span class="built_in">self</span><span class="built_in">.</span>progessSlider?<span class="built_in">.</span>value = Float( currentSecond / CMTimeGetSeconds(<span class="built_in">self</span><span class="built_in">.</span>player<span class="subst">!</span><span class="built_in">.</span>currentItem<span class="subst">!</span><span class="built_in">.</span><span class="built_in">duration</span>))</span><br><span class="line">                <span class="built_in">self</span><span class="built_in">.</span>player?<span class="built_in">.</span>currentItem<span class="subst">!</span><span class="built_in">.</span>seekToTime(CMTimeMakeWithSeconds(Float64(Float(CMTimeGetSeconds(<span class="built_in">duration</span>)) * <span class="built_in">self</span><span class="built_in">.</span>progessSlider<span class="subst">!</span><span class="built_in">.</span>value), Int32(CMTimeGetSeconds(<span class="built_in">duration</span>))))</span><br><span class="line">                <span class="built_in">self</span><span class="built_in">.</span>progressLabel?<span class="built_in">.</span>text = <span class="built_in">self</span><span class="built_in">.</span>getCurrentTime(currentSecond)</span><br><span class="line">                </span><br><span class="line">                <span class="built_in">self</span><span class="built_in">.</span>judgeWhetherEnd()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;s</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<p>如有任何疑问或问题请联系我:fishnewsdream@gmail.com,欢迎交流，共同提高！</p>
<p>Objective-C/Swift技术开发交流群201556264，讨论何种技术并不受限，欢迎各位大牛百家争鸣！</p>
<p><a href="http://www.ggteach.com/index.html" target="_blank" rel="external">刚刚在线工作室</a>，欢迎关注或提出建设性意见！</p>
<p><a href="http://bbs.ggteach.com" target="_blank" rel="external">刚刚在线论坛</a>, 欢迎踊跃提问或解答！</p>
<p>如有转载，请注明出处，谢谢！</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/AVPlayer、MoviePlayer/">AVPlayer、MoviePlayer</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/Swift/">Swift</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-遍地的奢华与奇缺的教养" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/02/26/遍地的奢华与奇缺的教养/" class="article-date">
  	<time datetime="2016-02-25T16:00:00.000Z" itemprop="datePublished">2016-02-26</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/02/26/遍地的奢华与奇缺的教养/">遍地的奢华与奇缺的教养</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>今天的中国，无论你走到哪里，几乎都能看见“奢华”这两个字。每一本时尚生活杂志都在不厌其烦地告诉你有关奢华的故事，每一个商品广告都试图让你感到它要卖的商品有多奢华。<br>于是房子是奢华的，车子是奢华的，大衣是奢华的，手表是奢华的，皮鞋也是奢华的，就连内裤也可以很奢华，乃至于我刚刚吃过的涮羊肉也标榜自己的用料十分奢华。本来这种东西是可以见怪不怪的，正所谓奢华见惯亦平常。</p>
<p>可是有一天，我在杂志上看到一篇介绍英国手工定制鞋的文章，作者先是不断渲染英国绅士的低调含蓄，一两千字之后笔锋忽然一转，他还是未能免俗地要大谈这鞋子有多奢华，并将其定位为“低调的奢华”。然后把绅士等同于品位，再将品位等同于奢华。许多媒体早就在“奢华”和“品位”之间画上等号了，但现在有人进一步连“绅士”也挂了上去，这就让我觉得有些刺眼了。</p>
<p>我的生活奢华不起，我的言行也离绅士甚远，可我总算读过不少传说中的英国绅士写的东西，在我的印象中，绅士和奢华根本是两个完全不同的概念。且看19世纪英国绅士之间的通信，关于绅士的品位，他们是这么说的：“×××的家朴实无华，真是难得的好品位。”“他是那种老派的绅士，一件大衣穿了20年。”他们会称赞一个人的朴实和惜物，低调而不张扬，却绝对不会把看得见的奢华当作品位，尤其不会把它视为绅士的品位。</p>
<p>就以一双手工制作的顶级皮鞋来说吧，它是很贵，但它可以穿上一二十年，这里头的学问不只是它自身的质量，更是你穿它、用它的态度。</p>
<p>首先，你会珍惜它，所以走路的姿势是端正的，不会在街上看见什么都随便踢一脚。其次，你愿意花点时间和心思去护理它，平常回家脱下来不忘为它拂尘拭灰，周末则悠悠闲闲地替它抹油补色，权当一种调剂身心的休息活动（就算他有佣人，他也宁愿自己动手）。所以这双鞋能够穿得久，10年之后，它略显老态，但不腐旧，看得出是经过了不错的照料，也看得出其主人对它的爱惜。</p>
<p><b> 这叫作绅士<b>。</b></b></p>
<p>不一定喜欢昂贵的身外物，但一定不随便花钱，朝秦暮楚。他的品位不在于他买了什么，而在于他的生活风格甚至为人；他拥有的物质不能说明他，他拥有物质的方式才能道出他是个怎么样的人。</p>
<p>当然，一个人不能做物质的奴隶，但他的人格、性情或许可以借着物质偶尔散发出来。<b>简单地讲，这就是教养<br>。</b></p>
<p>“教养”是一个何其古老、于今天何其陌生的词啊。这个词本来才是品位的绝配，不过，由于教养困难，奢华容易，我们今天才会把品位许给了奢华，让空洞的、无止境的消费去遮掩教养的匮乏。久而久之，甚至开始有人以为，英国的传统绅士皆以奢华为人生第一目标。如果你觉得“教养”太过抽象，我可以为你举一些没有教养的好例子。开着一部奔驰车在街上横冲直撞，觉得行人全是活该被吓死的贱民，这是没有教养的。手上戴着伯爵表，然后借醉酒臭骂上错菜的服务员小妹妹，这也是没有教养的。教养不必来自家教，更不是贵族的专利，上进的绅士更看重后天的自我养成。</p>
<p>然而，如今有力奢华地招摇过市之辈多如过江之鲫，甘于谦逊、力求品格善美的人却几不可闻，岂不可叹？我只不过是在北京一家火锅店见着它用“奢华”二字形容自己的材料，便忍不住发出这一大堆牢骚，这自然也是没有教养的表现。</p>
<p><br>奢华和教养的分界点在哪里？一个向外——求胜。一个向内——求安。无时无刻不在和他人相比，自然就倾慕奢华。无时无刻不在要求自己进步，自然就有了教养<br>。</p>
<p>真正的奢华是内心的高尚，这不是昂贵的物品所能装饰出来的。所以如何去做一个高尚的人，这才是我们最应该要去购买的“奢侈品”，当你拥有了这件专属于你的私人定制品时，你所散发出的气质会遮挡每一件价值不菲的身外之物。</p>
<p>在这个最美好，同时也是最物质的年代，我们都应变得物质。但这里所说的物质我们不能狭隘的只看它表面的意思、不能只想到现在的社会风气所熏陶出来的“物质”。现代社会的物质更准确的理解就是梁文道老师在文章中所说的“一个人的人格、性情或许可以借着物质偶尔散发出来。简单地讲，这就是教养。”</p>
<p>如果有了教养，你的内心自然会变得高尚，内心高尚的人，请你自信的告诉世人，你就是一件无与伦比的奢侈品。</p>
<blockquote>
<p>本文系转载</p>
<p>作者：梁文道</p>
<p>来源：新华网思客精选</p>
<p> 原题:《什么是奢华，什么是教养》</p>
</blockquote>
<hr>
<p>如有任何疑问或问题请联系我:fishnewsdream@gmail.com,欢迎交流，共同提高！</p>
<p>Objective-C/Swift技术开发交流群201556264，讨论何种技术并不受限，欢迎各位大牛百家争鸣！</p>
<p><a href="http://www.ggteach.com/index.html" target="_blank" rel="external">刚刚在线工作室</a>，欢迎关注或提出建设性意见！</p>
<p><a href="http://bbs.ggteach.com" target="_blank" rel="external">刚刚在线论坛</a>, 欢迎踊跃提问或解答！</p>
<p>如有转载，请注明出处，谢谢！</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/转载/">转载</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/随笔/">随笔</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/3/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2017 含笑饮砒霜
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
<span id="busuanzi_container_site_pv">
    本站总访问量<span id="busuanzi_value_site_pv"></span>次
</span>
<span id="busuanzi_container_page_pv">
  本文总阅读量<span id="busuanzi_value_page_pv"></span>次
</span>
</footer>

    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>